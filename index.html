<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø±Ø³Ù…ÙŠ Ù„Ù„ØªØ­Ù‚Ù‚ ÙˆØ§Ù„Ø¹Ø¶ÙˆÙŠØ©</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Cairo:wght@300;400;600;700;900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â• VARIABLES â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
:root{
  --em:#060f08; --em2:#0a1a0e; --em3:#0d2212;
  --g1:#c9a84c; --g2:#e8c96a; --g3:#9a7930; --g4:#f5dfa0;
  --wh:#fff; --tx:rgba(255,255,255,.9); --tx2:rgba(255,255,255,.58); --tx3:rgba(255,255,255,.3);
  --brd:rgba(201,168,76,.16); --brd2:rgba(201,168,76,.38);
  --card:rgba(255,255,255,.032); --card2:rgba(255,255,255,.062);
  --R:14px; --sh:0 8px 32px rgba(0,0,0,.4); --sh2:0 24px 70px rgba(0,0,0,.55);
  --ease:cubic-bezier(.4,0,.2,1);
}
*{margin:0;padding:0;box-sizing:border-box;}
html{scroll-behavior:smooth;}
body{font-family:'Cairo',sans-serif;background:var(--em);color:var(--wh);min-height:100vh;direction:rtl;overflow-x:hidden;-webkit-font-smoothing:antialiased;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â• SPECTACULAR BACKGROUND â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.bg-canvas{
  position:fixed;inset:0;z-index:0;overflow:hidden;pointer-events:none;
}
/* Animated aurora orbs */
.bg-orb{
  position:absolute;border-radius:50%;filter:blur(80px);
  animation:orbFloat 20s ease-in-out infinite;
  mix-blend-mode:screen;
}
.bg-orb:nth-child(1){width:600px;height:600px;top:-15%;right:-10%;background:radial-gradient(circle,rgba(26,107,60,.55),transparent 70%);animation-duration:18s;}
.bg-orb:nth-child(2){width:500px;height:500px;bottom:-10%;left:-8%;background:radial-gradient(circle,rgba(13,60,30,.65),transparent 70%);animation-duration:22s;animation-delay:-7s;}
.bg-orb:nth-child(3){width:350px;height:350px;top:40%;left:40%;background:radial-gradient(circle,rgba(201,168,76,.12),transparent 70%);animation-duration:15s;animation-delay:-4s;}
.bg-orb:nth-child(4){width:280px;height:280px;top:15%;left:20%;background:radial-gradient(circle,rgba(26,188,156,.1),transparent 70%);animation-duration:25s;animation-delay:-10s;}
@keyframes orbFloat{0%,100%{transform:translate(0,0) scale(1);}30%{transform:translate(40px,-30px) scale(1.08);}60%{transform:translate(-25px,45px) scale(.93);}80%{transform:translate(20px,-15px) scale(1.03);}}

/* Star particles */
.stars{position:absolute;inset:0;}
.star{position:absolute;border-radius:50%;background:rgba(201,168,76,.5);animation:twinkle 4s ease-in-out infinite;}
@keyframes twinkle{0%,100%{opacity:.2;transform:scale(1);}50%{opacity:.9;transform:scale(1.5);}}

/* Islamic geometric overlay */
.geo-overlay{
  position:absolute;inset:0;opacity:.045;
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='160' height='160'%3E%3Cdefs%3E%3Cpattern id='g' x='0' y='0' width='160' height='160' patternUnits='userSpaceOnUse'%3E%3Cpath d='M80 12 L91 44 L126 36 L101 62 L126 88 L91 80 L80 112 L69 80 L34 88 L59 62 L34 36 L69 44 Z' fill='none' stroke='%23c9a84c' stroke-width='1.4'/%3E%3Cpath d='M80 36 L92 48 L104 48 L104 64 L92 76 L80 76 L68 64 L68 48 Z' fill='none' stroke='%23c9a84c' stroke-width='.8' opacity='.5'/%3E%3Cline x1='80' y1='0' x2='80' y2='36' stroke='%23c9a84c' stroke-width='.5' opacity='.3'/%3E%3Cline x1='80' y1='76' x2='80' y2='160' stroke='%23c9a84c' stroke-width='.5' opacity='.3'/%3E%3Cline x1='0' y1='80' x2='38' y2='80' stroke='%23c9a84c' stroke-width='.5' opacity='.3'/%3E%3Cline x1='104' y1='80' x2='160' y2='80' stroke='%23c9a84c' stroke-width='.5' opacity='.3'/%3E%3Ccircle cx='0' cy='0' r='6' fill='none' stroke='%23c9a84c' stroke-width='.6' opacity='.3'/%3E%3Ccircle cx='160' cy='0' r='6' fill='none' stroke='%23c9a84c' stroke-width='.6' opacity='.3'/%3E%3Ccircle cx='0' cy='160' r='6' fill='none' stroke='%23c9a84c' stroke-width='.6' opacity='.3'/%3E%3Ccircle cx='160' cy='160' r='6' fill='none' stroke='%23c9a84c' stroke-width='.6' opacity='.3'/%3E%3C/pattern%3E%3C/defs%3E%3Crect width='160' height='160' fill='url(%23g)'/%3E%3C/svg%3E");
}
/* Shimmer sweep */
.shimmer{
  position:absolute;inset:0;
  background:linear-gradient(105deg,transparent 40%,rgba(201,168,76,.03) 50%,transparent 60%);
  animation:shimmerSweep 8s linear infinite;
}
@keyframes shimmerSweep{0%{transform:translateX(-100%) skewX(-15deg);}100%{transform:translateX(200%) skewX(-15deg);}}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â• PAGE TRANSITION â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#page-veil{
  position:fixed;inset:0;z-index:9998;pointer-events:none;
  background:linear-gradient(135deg,var(--em2),rgba(10,26,14,.98));
  opacity:0;
  transition:opacity .22s var(--ease);
}
#page-veil.in{opacity:1;pointer-events:all;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â• VIEWS â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#root{position:relative;z-index:1;min-height:100vh;}
.view{display:none;min-height:100vh;flex-direction:column;opacity:0;transform:translateY(18px);transition:opacity .4s var(--ease),transform .4s var(--ease);will-change:opacity,transform;}
.view.show{display:flex;opacity:1;transform:translateY(0);}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â• HEADER â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.hdr{background:linear-gradient(135deg,rgba(6,15,8,.96),rgba(10,26,14,.98));border-bottom:1.5px solid var(--g1);padding:0 2rem;display:flex;align-items:center;justify-content:space-between;height:66px;position:sticky;top:0;z-index:100;backdrop-filter:blur(24px);box-shadow:0 2px 24px rgba(0,0,0,.5),0 1px 0 rgba(201,168,76,.1);}
.logo{display:flex;align-items:center;gap:12px;text-decoration:none;cursor:pointer;}
.logo-mark{width:42px;height:42px;background:linear-gradient(135deg,var(--g2),var(--g3));border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:1.25rem;box-shadow:0 3px 14px rgba(201,168,76,.3),inset 0 1px 0 rgba(255,255,255,.15);flex-shrink:0;}
.logo-text h1{font-size:.92rem;font-weight:800;color:var(--wh);}
.logo-text span{font-size:.62rem;color:var(--g2);letter-spacing:.5px;}
.hdr-right{display:flex;gap:8px;align-items:center;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â• BUTTONS â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.btn{display:inline-flex;align-items:center;gap:6px;padding:9px 18px;border:none;cursor:pointer;border-radius:9px;font-family:'Cairo',sans-serif;font-size:.84rem;font-weight:700;transition:transform .2s var(--ease),box-shadow .2s,background .2s,opacity .2s;text-decoration:none;white-space:nowrap;position:relative;overflow:hidden;}
.btn::after{content:'';position:absolute;inset:0;background:rgba(255,255,255,.08);opacity:0;transition:opacity .2s;border-radius:inherit;}
.btn:hover::after{opacity:1;}
.btn:hover{transform:translateY(-2px);}
.btn:active{transform:translateY(0) scale(.98);}
.btn-gold{background:linear-gradient(135deg,var(--g2),var(--g3));color:#120d00;box-shadow:0 4px 16px rgba(201,168,76,.28);}
.btn-gold:hover{box-shadow:0 6px 24px rgba(201,168,76,.45);}
.btn-green{background:linear-gradient(135deg,#2ecc71,#1a8a4a);color:var(--wh);box-shadow:0 4px 14px rgba(26,138,74,.28);}
.btn-teal{background:linear-gradient(135deg,#1abc9c,#148f77);color:var(--wh);box-shadow:0 4px 14px rgba(26,188,156,.25);}
.btn-outline{background:transparent;color:var(--g1);border:1.5px solid var(--g1);}
.btn-outline:hover{background:var(--g1);color:#120d00;}
.btn-ghost{background:rgba(255,255,255,.06);color:var(--tx);border:1px solid rgba(255,255,255,.1);}
.btn-ghost:hover{background:rgba(255,255,255,.1);}
.btn-red{background:linear-gradient(135deg,#e74c3c,#a93226);color:var(--wh);}
.btn-blue{background:linear-gradient(135deg,#3498db,#1f6fa3);color:var(--wh);}
.btn-orange{background:linear-gradient(135deg,#f39c12,#b7770d);color:var(--wh);}
.btn-purple{background:linear-gradient(135deg,#9b59b6,#6c3483);color:var(--wh);}
.btn-sm{padding:6px 13px;font-size:.78rem;border-radius:7px;}
.btn-xs{padding:4px 9px;font-size:.72rem;border-radius:6px;}
.btn-w{width:100%;justify-content:center;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â• HERO â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.hero{padding:4rem 2rem 3.5rem;text-align:center;position:relative;}
.hero::before{content:'';position:absolute;top:0;left:50%;transform:translateX(-50%);width:220px;height:2px;background:linear-gradient(90deg,transparent,var(--g1),transparent);border-radius:2px;}
.bismi{font-family:'Amiri',serif;font-size:2.2rem;color:var(--g1);text-shadow:0 0 40px rgba(201,168,76,.4);margin-bottom:.4rem;animation:fadeUp .7s var(--ease) both;}
.tasl{color:var(--g2);opacity:.35;letter-spacing:14px;font-size:.9rem;margin:.5rem 0 1.6rem;animation:fadeUp .7s .1s var(--ease) both;}
@keyframes fadeUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}
.hero-pill{display:inline-flex;align-items:center;gap:7px;padding:5px 18px;background:rgba(201,168,76,.1);border:1px solid rgba(201,168,76,.28);border-radius:50px;color:var(--g2);font-size:.75rem;margin-bottom:1.1rem;animation:fadeUp .7s .15s var(--ease) both;}
.hero h1{font-family:'Amiri',serif;font-size:clamp(2rem,4.5vw,3.2rem);color:var(--wh);margin-bottom:.3rem;text-shadow:0 2px 24px rgba(201,168,76,.2);animation:fadeUp .7s .2s var(--ease) both;}
.hero h2{font-size:clamp(.85rem,2vw,1.1rem);color:var(--g2);font-weight:400;margin-bottom:1rem;animation:fadeUp .7s .25s var(--ease) both;}
.hero p{color:var(--tx2);max-width:520px;margin:0 auto 2rem;line-height:2;font-size:.88rem;animation:fadeUp .7s .3s var(--ease) both;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â• SERVICE CARDS â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.svc-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:1.4rem;animation:fadeUp .7s .35s var(--ease) both;}
.svc{background:var(--card);border:1px solid var(--brd);border-radius:18px;padding:2.2rem 1.6rem;text-align:center;cursor:pointer;transition:transform .35s var(--ease),border-color .3s,background .3s,box-shadow .35s;position:relative;overflow:hidden;}
.svc::before{content:'';position:absolute;inset:0;background:radial-gradient(circle at 50% 0%,rgba(201,168,76,.1),transparent 60%);opacity:0;transition:opacity .4s;}
.svc:hover::before{opacity:1;}
.svc:hover{transform:translateY(-8px);border-color:var(--brd2);background:var(--card2);box-shadow:0 16px 50px rgba(0,0,0,.35),0 0 0 1px rgba(201,168,76,.14);}
.svc-icon{width:70px;height:70px;margin:0 auto 1rem;border-radius:18px;display:flex;align-items:center;justify-content:center;font-size:1.9rem;transition:transform .3s var(--ease);}
.svc:hover .svc-icon{transform:scale(1.12);}
.svc-icon.gold{background:linear-gradient(135deg,rgba(201,168,76,.22),rgba(201,168,76,.08));border:1px solid rgba(201,168,76,.25);}
.svc-icon.teal{background:linear-gradient(135deg,rgba(26,188,156,.2),rgba(26,188,156,.08));border:1px solid rgba(26,188,156,.22);}
.svc-icon.blue{background:linear-gradient(135deg,rgba(52,152,219,.2),rgba(52,152,219,.08));border:1px solid rgba(52,152,219,.22);}
.svc h3{color:var(--g2);font-size:1.08rem;margin-bottom:.5rem;font-weight:800;}
.svc p{color:var(--tx2);font-size:.83rem;line-height:1.85;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â• CONTAINER â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.con{max-width:860px;margin:0 auto;padding:2rem 1.4rem;}
.con-w{max-width:1200px;margin:0 auto;padding:1.6rem 1.4rem;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â• CARD â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.card{background:var(--card);border:1px solid var(--brd);border-radius:var(--R);overflow:hidden;}
.card-hd{padding:1rem 1.3rem;background:linear-gradient(135deg,rgba(26,107,60,.28),rgba(13,74,40,.38));border-bottom:1px solid var(--brd);display:flex;align-items:center;gap:10px;}
.card-hd .cic{width:34px;height:34px;border-radius:9px;background:rgba(201,168,76,.14);display:flex;align-items:center;justify-content:center;color:var(--g1);font-size:.9rem;flex-shrink:0;}
.card-hd h3{color:var(--wh);font-size:.92rem;font-weight:700;line-height:1.3;}
.card-hd span{font-size:.66rem;color:var(--g2);}
.card-b{padding:1.3rem;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â• FORM â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.fg{margin-bottom:1.1rem;}
.fl{display:block;color:var(--g2);font-size:.8rem;font-weight:700;margin-bottom:5px;}
.rq{color:#e74c3c;margin-right:3px;}
.fc{width:100%;padding:11px 14px;background:rgba(255,255,255,.05);border:1.5px solid rgba(201,168,76,.18);border-radius:9px;color:var(--wh);font-family:'Cairo',sans-serif;font-size:.875rem;transition:border-color .22s,background .22s,box-shadow .22s;outline:none;}
.fc:focus{border-color:var(--g1);background:rgba(255,255,255,.08);box-shadow:0 0 0 3px rgba(201,168,76,.12);}
.fc::placeholder{color:var(--tx3);}
textarea.fc{resize:vertical;min-height:280px;line-height:2.1;}
select.fc option{background:#0a1f0f;color:var(--wh);}
.fr2{display:grid;grid-template-columns:1fr 1fr;gap:1rem;}
.fr3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:1rem;}
@media(max-width:580px){.fr2,.fr3{grid-template-columns:1fr;}}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â• STEPS â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.steps{display:flex;align-items:center;justify-content:center;margin:1.5rem 0 2rem;}
.step{display:flex;flex-direction:column;align-items:center;gap:5px;flex:1;max-width:140px;}
.snum{width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:.82rem;transition:background .3s,color .3s,box-shadow .3s,transform .3s var(--ease);background:rgba(255,255,255,.07);color:var(--tx3);border:2px solid rgba(255,255,255,.1);}
.step.on .snum{background:linear-gradient(135deg,var(--g2),var(--g3));color:#120d00;border-color:transparent;box-shadow:0 4px 16px rgba(201,168,76,.38);transform:scale(1.12);}
.step.ok .snum{background:linear-gradient(135deg,#2ecc71,#1a8a4a);color:var(--wh);border-color:transparent;}
.slabel{font-size:.67rem;color:var(--tx3);text-align:center;}
.step.on .slabel{color:var(--g2);}
.step.ok .slabel{color:rgba(255,255,255,.62);}
.sbar{flex:1;height:2px;background:rgba(255,255,255,.07);max-width:55px;margin-top:-20px;transition:background .4s;}
.sbar.ok{background:linear-gradient(90deg,#2ecc71,#1a8a4a);}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â• ALERTS â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.al{padding:10px 14px;border-radius:9px;font-size:.82rem;display:flex;align-items:flex-start;gap:8px;margin-bottom:.9rem;animation:fadeUp .3s var(--ease);}
.al-err{background:rgba(231,76,60,.12);border:1px solid rgba(231,76,60,.24);color:#f1948a;}
.al-ok{background:rgba(46,204,113,.12);border:1px solid rgba(46,204,113,.24);color:#82e0aa;}
.al-warn{background:rgba(243,156,18,.1);border:1px solid rgba(243,156,18,.22);color:#f5b041;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â• BADGES â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.badge{display:inline-flex;align-items:center;gap:3px;padding:3px 10px;border-radius:50px;font-size:.7rem;font-weight:800;}
.b-pend{background:rgba(243,156,18,.14);color:#f5b041;border:1px solid rgba(243,156,18,.25);}
.b-proc{background:rgba(52,152,219,.14);color:#5dade2;border:1px solid rgba(52,152,219,.25);}
.b-done{background:rgba(46,204,113,.14);color:#58d68d;border:1px solid rgba(46,204,113,.25);}
.b-rej {background:rgba(231,76,60,.14);color:#ec7063;border:1px solid rgba(231,76,60,.25);}
.b-vrf {background:rgba(155,89,182,.14);color:#c39bd3;border:1px solid rgba(155,89,182,.25);}
.b-mem {background:rgba(26,188,156,.14);color:#76d7c4;border:1px solid rgba(26,188,156,.25);}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â• TRACK PAGE â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.search-hero{background:linear-gradient(135deg,rgba(26,107,60,.2),rgba(201,168,76,.07));border:1px solid var(--brd);border-radius:20px;padding:3rem 2rem;text-align:center;margin-bottom:2rem;}
.search-hero h2{font-family:'Amiri',serif;font-size:1.8rem;margin-bottom:.5rem;}
.search-hero p{color:var(--tx2);font-size:.86rem;margin-bottom:1.6rem;line-height:1.8;}
.search-box{display:flex;gap:10px;max-width:500px;margin:0 auto;}
.search-box .fc{flex:1;font-size:.95rem;}
.rcard{background:var(--card);border:1px solid var(--brd);border-radius:14px;padding:1.3rem 1.4rem;margin-bottom:.9rem;transition:border-color .25s,transform .25s var(--ease),box-shadow .25s;animation:fadeUp .35s var(--ease) both;}
.rcard:hover{border-color:var(--brd2);transform:translateX(-3px);box-shadow:0 8px 30px rgba(0,0,0,.25);}
.rcard-top{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:7px;margin-bottom:.9rem;}
.rcard-grid{display:grid;grid-template-columns:1fr 1fr;gap:6px;font-size:.82rem;color:var(--tx2);}
.rcard-grid b{color:var(--tx);}
.rej-note{margin-top:.9rem;padding:10px 14px;background:rgba(231,76,60,.1);border:1px solid rgba(231,76,60,.22);border-radius:9px;font-size:.8rem;color:#ec7063;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â• UPLOAD â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.upz{border:2px dashed rgba(201,168,76,.28);border-radius:12px;padding:2rem;text-align:center;cursor:pointer;transition:border-color .25s,background .25s;background:rgba(201,168,76,.025);position:relative;}
.upz:hover{border-color:var(--g1);background:rgba(201,168,76,.06);}
.upz input[type=file]{position:absolute;inset:0;opacity:0;cursor:pointer;width:100%;height:100%;}
.upz-icon{font-size:2.2rem;color:var(--g1);margin-bottom:.7rem;}
.upz p{color:var(--tx2);font-size:.86rem;}
.upz small{color:var(--tx3);font-size:.73rem;}
.uprev{display:none;margin-top:.9rem;}
.uprev img{max-width:120px;border-radius:9px;border:2px solid var(--g1);box-shadow:0 4px 16px rgba(201,168,76,.2);}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â• SUCCESS â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.success-card{text-align:center;padding:3.5rem 2rem;background:var(--card);border:1px solid var(--brd);border-radius:var(--R);animation:fadeUp .4s var(--ease);}
.success-id{display:inline-block;padding:.6rem 1.8rem;background:rgba(201,168,76,.1);border:1px solid rgba(201,168,76,.22);border-radius:10px;font-size:1.4rem;font-weight:900;color:var(--g1);letter-spacing:3px;margin:.8rem 0 .6rem;font-family:monospace;}
.copy-btn{background:none;border:1px solid var(--brd);color:var(--g2);cursor:pointer;padding:5px 12px;border-radius:6px;font-size:.75rem;font-family:'Cairo',sans-serif;margin-right:8px;transition:background .2s,color .2s;}
.copy-btn:hover{background:rgba(201,168,76,.12);color:var(--g1);}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â• LOADING â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.loading-overlay{position:fixed;inset:0;z-index:9997;background:rgba(6,15,8,.85);backdrop-filter:blur(8px);display:none;flex-direction:column;align-items:center;justify-content:center;gap:1rem;}
.loading-overlay.show{display:flex;}
.spinner{width:50px;height:50px;border:3px solid rgba(201,168,76,.2);border-top-color:var(--g1);border-radius:50%;animation:spin 1s linear infinite;}
@keyframes spin{to{transform:rotate(360deg);}}
.loading-overlay p{color:var(--g2);font-size:.9rem;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â• LOGIN â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.login-wrap{display:flex;align-items:center;justify-content:center;min-height:100vh;padding:2rem;}
.login-box{width:100%;max-width:380px;background:rgba(10,26,14,.92);backdrop-filter:blur(30px);border:1px solid var(--brd);border-radius:22px;overflow:hidden;box-shadow:var(--sh2);}
.login-head{padding:2.2rem;text-align:center;background:linear-gradient(135deg,rgba(26,107,60,.4),rgba(13,74,40,.5));border-bottom:1px solid var(--brd);}
.login-head .moon{width:64px;height:64px;margin:0 auto .9rem;background:linear-gradient(135deg,rgba(201,168,76,.2),rgba(201,168,76,.05));border:1.5px solid rgba(201,168,76,.3);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.8rem;}
.login-head h2{font-size:1.3rem;color:var(--wh);}
.login-head p{font-size:.73rem;color:var(--g2);margin-top:4px;}
.login-body{padding:1.6rem;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â• ADMIN â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#view-admin{background:var(--em);}
.admin-layout{display:flex;height:calc(100vh - 66px);overflow:hidden;}
.sidebar{width:240px;flex-shrink:0;background:rgba(6,15,8,.97);border-left:1px solid var(--brd);display:flex;flex-direction:column;overflow-y:auto;}
.sb-logo{padding:1.2rem 1rem;border-bottom:1px solid var(--brd);display:flex;align-items:center;gap:10px;}
.sb-logo .dot{width:10px;height:10px;border-radius:50%;background:var(--g1);box-shadow:0 0 10px rgba(201,168,76,.7);flex-shrink:0;}
.sb-logo span{font-size:.8rem;font-weight:700;color:var(--g2);}
.sb-nav{padding:.8rem 0;flex:1;}
.sb-section{padding:.4rem 1rem .2rem;font-size:.62rem;font-weight:800;color:var(--tx3);letter-spacing:1.5px;text-transform:uppercase;}
.sb-item{display:flex;align-items:center;gap:10px;padding:.65rem 1.1rem;cursor:pointer;transition:background .2s,color .2s,border-color .2s;color:var(--tx2);font-size:.82rem;font-weight:600;border-right:3px solid transparent;margin-bottom:2px;}
.sb-item i{width:18px;text-align:center;font-size:.88rem;flex-shrink:0;}
.sb-item:hover{background:rgba(201,168,76,.07);color:var(--wh);}
.sb-item.act{background:rgba(201,168,76,.1);color:var(--g2);border-right-color:var(--g1);}
.sb-badge{margin-right:auto;min-width:20px;height:20px;padding:0 6px;background:rgba(201,168,76,.2);color:var(--g2);border-radius:50px;font-size:.67rem;font-weight:800;display:flex;align-items:center;justify-content:center;}
.sb-bottom{padding:1rem;border-top:1px solid var(--brd);}
.admin-main{flex:1;overflow-y:auto;background:rgba(0,0,0,.12);}
.admin-topbar{padding:.9rem 1.5rem;border-bottom:1px solid var(--brd);display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:8px;background:rgba(6,15,8,.75);backdrop-filter:blur(12px);position:sticky;top:0;z-index:10;}
.admin-topbar h2{font-size:1rem;font-weight:800;}
.admin-topbar p{font-size:.72rem;color:var(--tx3);}
.a-section{display:none;}
.a-section.act{display:block;animation:fadeUp .3s var(--ease);}
.stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:1rem;margin-bottom:1.5rem;}
.stat-card{background:var(--card);border:1px solid var(--brd);border-radius:14px;padding:1.2rem 1rem;transition:transform .25s var(--ease),border-color .25s,box-shadow .25s;}
.stat-card:hover{transform:translateY(-3px);border-color:var(--brd2);box-shadow:0 10px 28px rgba(0,0,0,.3);}
.stat-icon-wrap{width:40px;height:40px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:1.1rem;margin-bottom:.7rem;}
.stat-num{font-size:2rem;font-weight:900;line-height:1;margin-bottom:3px;}
.stat-label{font-size:.73rem;color:var(--tx2);}
.table-wrap{overflow-x:auto;border-radius:var(--R);}
table{width:100%;border-collapse:collapse;font-size:.81rem;}
thead tr{background:linear-gradient(135deg,rgba(26,107,60,.32),rgba(13,74,40,.42));border-bottom:2px solid rgba(201,168,76,.22);}
thead th{padding:11px 13px;color:var(--g2);font-weight:800;text-align:right;white-space:nowrap;font-size:.75rem;letter-spacing:.3px;}
tbody tr{border-bottom:1px solid rgba(255,255,255,.04);transition:background .18s;}
tbody tr:hover{background:rgba(255,255,255,.03);}
tbody td{padding:10px 13px;color:var(--tx);vertical-align:middle;}
.td-id{font-family:monospace;color:var(--g1);font-size:.75rem;font-weight:700;}
.act-btns{display:flex;gap:4px;flex-wrap:nowrap;}
.filter-bar{display:flex;align-items:center;gap:10px;flex-wrap:wrap;margin-bottom:1.2rem;}
.filter-bar .fc{max-width:280px;flex:1;}
.chip-grp{display:flex;gap:6px;flex-wrap:wrap;}
.chip{padding:5px 13px;border-radius:50px;background:rgba(255,255,255,.05);border:1.5px solid rgba(255,255,255,.08);color:var(--tx2);cursor:pointer;font-family:'Cairo',sans-serif;font-size:.75rem;font-weight:700;transition:background .2s,border-color .2s,color .2s;}
.chip:hover,.chip.on{background:rgba(201,168,76,.12);border-color:rgba(201,168,76,.32);color:var(--g2);}
.empty{text-align:center;padding:3rem;color:var(--tx3);}
.empty i{font-size:2.5rem;margin-bottom:.8rem;color:rgba(201,168,76,.14);display:block;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â• MODAL â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.75);z-index:999;align-items:center;justify-content:center;padding:1rem;backdrop-filter:blur(8px);}
.overlay.open{display:flex;animation:fadeIn .2s var(--ease);}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
.modal{background:linear-gradient(135deg,#0a2010,#071408);border:1px solid var(--brd2);border-radius:var(--R);width:100%;max-width:540px;max-height:90vh;overflow-y:auto;box-shadow:var(--sh2);animation:scaleUp .25s var(--ease) both;}
.modal-lg{max-width:680px;}
@keyframes scaleUp{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}
.mhd{padding:1rem 1.3rem;border-bottom:1px solid var(--brd);display:flex;align-items:center;justify-content:space-between;background:rgba(26,107,60,.15);}
.mhd h3{color:var(--wh);font-size:.95rem;font-weight:800;}
.mcl{width:30px;height:30px;background:rgba(231,76,60,.14);border:none;cursor:pointer;border-radius:7px;color:#e74c3c;font-size:.85rem;display:flex;align-items:center;justify-content:center;transition:background .2s;}
.mcl:hover{background:rgba(231,76,60,.3);}
.mbd{padding:1.3rem;}
.mft{padding:.9rem 1.3rem;border-top:1px solid rgba(255,255,255,.05);display:flex;gap:8px;justify-content:flex-end;flex-wrap:wrap;}
.drow{background:rgba(255,255,255,.04);border-radius:9px;padding:10px 13px;margin-bottom:7px;}
.drow label{display:block;font-size:.68rem;color:var(--g2);margin-bottom:2px;font-weight:700;}
.drow .val{color:var(--wh);font-size:.86rem;}
.drow .val.pre{white-space:pre-wrap;line-height:2.05;font-size:.83rem;}
.drow2{display:grid;grid-template-columns:1fr 1fr;gap:7px;margin-bottom:7px;}

/* File previews in admin */
.file-preview{margin-top:.5rem;}
.file-preview img{max-width:160px;max-height:200px;border-radius:8px;border:2px solid rgba(201,168,76,.3);display:block;margin-bottom:.5rem;}
.file-actions{display:flex;gap:7px;margin-top:.4rem;flex-wrap:wrap;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â• SCROLLBAR â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
::-webkit-scrollbar{width:5px;height:5px;}
::-webkit-scrollbar-track{background:rgba(0,0,0,.1);}
::-webkit-scrollbar-thumb{background:rgba(201,168,76,.25);border-radius:3px;}
::-webkit-scrollbar-thumb:hover{background:rgba(201,168,76,.45);}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â• RESPONSIVE â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@media(max-width:900px){.sidebar{width:200px;}}
@media(max-width:720px){
  .hdr{padding:0 1rem;}
  .con,.con-w{padding:1.4rem 1rem;}
  .hero{padding:2.5rem 1rem 2rem;}
  .admin-layout{flex-direction:column;}
  .sidebar{width:100%;height:auto;border-left:none;border-bottom:1px solid var(--brd);}
  .sb-nav{display:flex;padding:.5rem;overflow-x:auto;gap:4px;}
  .sb-section{display:none;}
  .sb-item{border-right:none;border-bottom:3px solid transparent;border-radius:8px;white-space:nowrap;padding:.5rem .9rem;}
  .sb-item.act{border-right-color:transparent;border-bottom-color:var(--g1);}
  .admin-main{height:auto;}
  table{font-size:.75rem;}
  thead th,tbody td{padding:8px 9px;}
  .act-btns{flex-wrap:wrap;}
  .fr2,.fr3{grid-template-columns:1fr;}
  .rcard-grid{grid-template-columns:1fr;}
}


</style>
</head>
<body>

<!-- â•â•â•â•â•â• ANIMATED BACKGROUND â•â•â•â•â•â• -->
<div class="bg-canvas">
  <div class="bg-orb"></div>
  <div class="bg-orb"></div>
  <div class="bg-orb"></div>
  <div class="bg-orb"></div>
  <div class="stars" id="star-field"></div>
  <div class="geo-overlay"></div>
  <div class="shimmer"></div>
</div>

<!-- Page transition veil -->
<div id="page-veil"></div>

<!-- Loading overlay -->
<div class="loading-overlay" id="loading">
  <div class="spinner"></div>
  <p>Ø¬Ø§Ø±Ù Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...</p>
</div>

<div id="root">

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     HOME PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="view-home" class="view show">
  <header class="hdr">
    <div class="logo" onclick="nav('home')">
      <div class="logo-mark">ğŸ•Œ</div>
      <div class="logo-text"><h1>Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø±Ø³Ù…ÙŠ</h1><span>Official System</span></div>
    </div>
    <div class="hdr-right">
      <button class="btn btn-ghost btn-sm" onclick="nav('track')"><i class="fas fa-search"></i> Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø·Ù„Ø¨</button>
    </div>
  </header>

  <div class="hero">
    <div class="bismi">Ø¨ÙØ³Ù’Ù…Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ø§Ù„Ø±ÙÙ‘Ø­Ù’Ù…ÙÙ°Ù†Ù Ø§Ù„Ø±ÙÙ‘Ø­ÙÙŠÙ…Ù</div>
    <div class="tasl">âœ¦ âœ¦ âœ¦</div>
    <div class="hero-pill"><i class="fas fa-shield-alt"></i> Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø±Ø³Ù…ÙŠ Ù„Ù„ØªØ­Ù‚Ù‚ ÙˆØ§Ù„Ø¹Ø¶ÙˆÙŠØ©</div>
    <h1>Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù†Ø¸Ø§Ù…Ù†Ø§ Ø§Ù„Ø±Ø³Ù…ÙŠ</h1>
    <h2>Official Verification &amp; Membership System</h2>
    <p>Ø§Ø®ØªØ± Ø§Ù„Ø®Ø¯Ù…Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù„ØªÙ‚Ø¯ÙŠÙ… Ø·Ù„Ø¨Ùƒ Ø£Ùˆ Ù…ØªØ§Ø¨Ø¹Ø© Ø­Ø§Ù„Ø© Ø·Ù„Ø¨Ø§ØªÙƒ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©</p>
  </div>

  <div class="con">
<div class="svc-grid">
      <div class="svc" onclick="nav('verif')">
        <div class="svc-icon gold">ğŸ”</div>
        <h3>Ø·Ù„Ø¨ ØªØ­Ù‚Ù‚</h3>
        <p>ØªÙ‚Ø¯ÙŠÙ… Ø·Ù„Ø¨ ØªØ­Ù‚Ù‚ Ø±Ø³Ù…ÙŠ ÙŠØªØ¶Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ© ÙˆØ£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø³Ù„Ø§Ù„Ø© ÙˆØ§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</p>
        <div style="margin-top:1.4rem;">
          <span class="btn btn-gold" style="display:inline-flex;gap:6px;font-size:.82rem;padding:8px 18px;">
            <i class="fas fa-plus-circle"></i> ØªÙ‚Ø¯ÙŠÙ… Ø·Ù„Ø¨ ØªØ­Ù‚Ù‚
          </span>
        </div>
      </div>
      <div class="svc" onclick="nav('memb')">
        <div class="svc-icon teal">ğŸªª</div>
        <h3>Ø·Ù„Ø¨ Ø¹Ø¶ÙˆÙŠØ©</h3>
        <p>Ø§Ù„ØªÙ‚Ø¯Ù… Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¹Ø¶ÙˆÙŠØ© Ø±Ø³Ù…ÙŠØ© Ø¨Ù…Ù„Ø¡ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¹Ø¶ÙˆÙŠØ© Ø§Ù„Ø´Ø§Ù…Ù„ Ù…Ø¹ ÙƒØ§ÙØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</p>
        <div style="margin-top:1.4rem;">
          <span class="btn btn-teal" style="display:inline-flex;gap:6px;font-size:.82rem;padding:8px 18px;">
            <i class="fas fa-user-plus"></i> ØªÙ‚Ø¯ÙŠÙ… Ø·Ù„Ø¨ Ø¹Ø¶ÙˆÙŠØ©
          </span>
        </div>
      </div>
      <div class="svc" onclick="nav('track')">
        <div class="svc-icon blue">ğŸ”</div>
        <h3>Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h3>
        <p>ØªØªØ¨Ø¹ Ø­Ø§Ù„Ø© Ø·Ù„Ø¨Ùƒ Ø¨Ø³Ù‡ÙˆÙ„Ø© ÙˆÙ…ØªØ§Ø¨Ø¹Ø© ØªØ­Ø¯ÙŠØ«Ø§ØªÙ‡ Ø¨Ø´ÙƒÙ„ ÙÙˆØ±ÙŠ</p>
        <div style="margin-top:1.4rem;">
          <span class="btn btn-outline" style="display:inline-flex;gap:6px;font-size:.82rem;padding:8px 18px;">
            <i class="fas fa-search"></i> Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø·Ù„Ø¨
          </span>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     VERIFICATION REQUEST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="view-verif" class="view">
  <header class="hdr">
    <div class="logo" onclick="nav('home')">
      <div class="logo-mark">ğŸ”</div>
      <div class="logo-text"><h1>Ø·Ù„Ø¨ ØªØ­Ù‚Ù‚ Ø¬Ø¯ÙŠØ¯</h1><span>New Verification Request</span></div>
    </div>
    <div class="hdr-right">
      <button class="btn btn-ghost btn-sm" onclick="nav('home')"><i class="fas fa-home"></i> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
    </div>
  </header>

  <div class="con">
    <div class="steps">
      <div class="step on" id="vs1"><div class="snum">1</div><div class="slabel">Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©</div></div>
      <div class="sbar" id="vb1"></div>
      <div class="step" id="vs2"><div class="snum">2</div><div class="slabel">Ø±ÙØ¹ Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª</div></div>
      <div class="sbar" id="vb2"></div>
      <div class="step" id="vs3"><div class="snum">3</div><div class="slabel">Ø§Ù„ØªØ£ÙƒÙŠØ¯</div></div>
    </div>

    <div id="vp1">
      <div class="card">
        <div class="card-hd"><div class="cic"><i class="fas fa-user-edit"></i></div><div><h3>Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù‚Ø¯Ù… Ø§Ù„Ø·Ù„Ø¨</h3><span>Personal Information</span></div></div>
        <div class="card-b">
          <div class="fr2">
            <div class="fg"><label class="fl"><span class="rq">*</span>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„ | Full Name</label><input id="vn" type="text" class="fc" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„..."></div>
            <div class="fg"><label class="fl"><span class="rq">*</span>Ø§Ù„Ù…Ù†ØµØ¨ / Ø§Ù„ÙˆØ¸ÙŠÙØ© | Position</label><input id="vpos" type="text" class="fc" placeholder="Ø§Ù„Ù…Ù†ØµØ¨ Ø£Ùˆ Ø§Ù„ÙˆØ¸ÙŠÙØ©..."></div>
          </div>
          <div class="fg"><label class="fl"><span class="rq">*</span>Ø§Ù„Ø¹Ù†ÙˆØ§Ù† | Address</label><input id="va" type="text" class="fc" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙƒØ§Ù…Ù„..."></div>
          <div class="fg">
            <label class="fl"><span class="rq">*</span>Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø³Ù„Ø§Ù„Ø© | Lineage Names</label>
            <p style="font-size:.72rem;color:var(--tx3);margin-bottom:6px;">Ø£Ø¯Ø®Ù„ Ø­ØªÙ‰ 45 Ø§Ø³Ù…Ø§Ù‹ â€” ÙƒÙ„ Ø§Ø³Ù… ÙÙŠ Ø³Ø·Ø± Ù…Ù†ÙØµÙ„</p>
            <textarea id="vl" class="fc" placeholder="1. Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„&#10;2. Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ø§Ù†ÙŠ&#10;...&#10;(ÙŠØ³ØªÙˆØ¹Ø¨ Ø­ØªÙ‰ 45 Ø§Ø³Ù…Ø§Ù‹)"></textarea>
          </div>
          <div class="fr2">
            <div class="fg"><label class="fl">ğŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ® | Date</label><input id="vd" type="text" class="fc" readonly style="background:rgba(255,255,255,.02);cursor:default;"></div>
            <div class="fg"><label class="fl">ğŸ• Ø§Ù„ÙˆÙ‚Øª | Time</label><input id="vt" type="text" class="fc" readonly style="background:rgba(255,255,255,.02);cursor:default;"></div>
          </div>
          <div id="ve1" class="al al-err" style="display:none;"><i class="fas fa-exclamation-circle"></i><span></span></div>
          <button class="btn btn-gold btn-w" onclick="vNext()"><i class="fas fa-arrow-left"></i> Ø§Ù„ØªØ§Ù„ÙŠ: Ø±ÙØ¹ Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª</button>
        </div>
      </div>
    </div>

    <div id="vp2" style="display:none;">
      <div class="card">
        <div class="card-hd"><div class="cic"><i class="fas fa-cloud-upload-alt"></i></div><div><h3>Ø±ÙØ¹ Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</h3><span>Upload Documents</span></div></div>
        <div class="card-b">
          <div class="fg">
            <label class="fl"><span class="rq">*</span>Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ© â€” Ø­Ø¬Ù… Ø¬ÙˆØ§Ø² Ø§Ù„Ø³ÙØ± | Passport Photo</label>
            <div class="upz"><input type="file" id="vf1" accept=".jpg,.jpeg,.png" onchange="hf('vf1','upv1','upn1',true)"><div class="upz-icon">ğŸ–¼ï¸</div><p>Ø§Ø³Ø­Ø¨ ÙˆØ£ÙÙ„Øª Ø£Ùˆ Ø§Ù†Ù‚Ø± Ù„Ù„Ø§Ø®ØªÙŠØ§Ø±</p><small>JPG / PNG ÙÙ‚Ø· â€” Ø£Ù‚ØµÙ‰ Ø­Ø¬Ù… 2MB</small></div>
            <div class="uprev" id="upv1"><img id="upv1-img" src="" alt=""><p id="upn1" style="font-size:.75rem;color:var(--tx2);margin-top:4px;"></p></div>
          </div>
          <div class="fg">
            <label class="fl"><span class="rq">*</span>ÙˆØ«ÙŠÙ‚Ø© Ø§Ù„Ø³Ù„Ø§Ù„Ø© | Lineage Document</label>
            <div class="upz"><input type="file" id="vf2" accept=".pdf,.jpg,.jpeg" onchange="hf('vf2','upv2','upn2',false)"><div class="upz-icon">ğŸ“„</div><p>Ø§Ø³Ø­Ø¨ ÙˆØ£ÙÙ„Øª Ø£Ùˆ Ø§Ù†Ù‚Ø± Ù„Ù„Ø§Ø®ØªÙŠØ§Ø±</p><small>PDF Ø£Ùˆ JPG ÙÙ‚Ø· â€” Ø£Ù‚ØµÙ‰ Ø­Ø¬Ù… 5MB</small></div>
            <div class="uprev" id="upv2"><p id="upn2" style="font-size:.85rem;color:var(--g1);"></p></div>
          </div>
          <div id="ve2" class="al al-err" style="display:none;"><i class="fas fa-exclamation-circle"></i><span></span></div>
          <div style="display:flex;gap:9px;flex-wrap:wrap;">
            <button class="btn btn-ghost" onclick="vstep(1)"><i class="fas fa-arrow-right"></i> Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
            <button id="vsub-btn" class="btn btn-gold" style="flex:1;justify-content:center;" onclick="vsub()"><i class="fas fa-paper-plane"></i> Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹</button>
          </div>
        </div>
      </div>
    </div>

    <div id="vp3" style="display:none;">
      <div class="success-card">
        <div style="font-size:3.8rem;margin-bottom:.8rem;animation:fadeUp .5s var(--ease);">ğŸ‰</div>
        <h2 style="font-family:'Amiri',serif;font-size:1.9rem;color:var(--g1);margin-bottom:.3rem;">ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„ØªØ­Ù‚Ù‚ Ø¨Ù†Ø¬Ø§Ø­!</h2>
        <p style="color:var(--tx2);font-size:.86rem;margin-bottom:.5rem;">Verification request submitted successfully</p>
        <div class="success-id" id="vsid"></div>
        <p style="color:var(--tx3);font-size:.79rem;margin-bottom:2rem;">ÙŠÙ…ÙƒÙ†Ùƒ Ù…ØªØ§Ø¨Ø¹Ø© Ø­Ø§Ù„Ø© Ø·Ù„Ø¨Ùƒ Ù…Ù† Ø®Ù„Ø§Ù„ ØµÙØ­Ø© Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©</p>
        <div style="display:flex;gap:9px;justify-content:center;flex-wrap:wrap;">
          <button class="btn btn-gold" onclick="nav('track')"><i class="fas fa-search"></i> Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø·Ù„Ø¨</button>
          <button class="btn btn-ghost" onclick="vreset();nav('home')"><i class="fas fa-home"></i> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     MEMBERSHIP REQUEST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="view-memb" class="view">
  <header class="hdr">
    <div class="logo" onclick="nav('home')">
      <div class="logo-mark">ğŸªª</div>
      <div class="logo-text"><h1>Ø·Ù„Ø¨ Ø¹Ø¶ÙˆÙŠØ© Ø¬Ø¯ÙŠØ¯</h1><span>New Membership Request</span></div>
    </div>
    <div class="hdr-right">
      <button class="btn btn-ghost btn-sm" onclick="nav('home')"><i class="fas fa-home"></i> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
    </div>
  </header>

  <div class="con">
    <div style="text-align:center;margin:1.5rem 0 1.8rem;animation:fadeUp .5s var(--ease);">
      <div style="display:inline-flex;align-items:center;gap:7px;padding:5px 18px;background:rgba(26,188,156,.1);border:1px solid rgba(26,188,156,.25);border-radius:50px;color:#76d7c4;font-size:.75rem;margin-bottom:.9rem;">
        <i class="fas fa-id-card"></i> Ù†Ù…ÙˆØ°Ø¬ Ø·Ù„Ø¨ Ø§Ù„Ø¹Ø¶ÙˆÙŠØ© Ø§Ù„Ø±Ø³Ù…ÙŠ
      </div>
      <h2 style="font-family:'Amiri',serif;font-size:1.7rem;">Ø·Ù„Ø¨ Ø¹Ø¶ÙˆÙŠØ© Ø¬Ø¯ÙŠØ¯</h2>
    </div>

    <div id="mform">
      <div class="card">
        <div class="card-hd" style="background:linear-gradient(135deg,rgba(26,188,156,.15),rgba(13,74,40,.35));"><div class="cic" style="background:rgba(26,188,156,.14);color:#76d7c4;"><i class="fas fa-id-card"></i></div><div><h3>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø¶ÙˆÙŠØ©</h3><span>Membership Details</span></div></div>
        <div class="card-b">
          <div class="fr2">
            <div class="fg"><label class="fl"><span class="rq">*</span>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„ | Full Name</label><input id="mn" type="text" class="fc" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„..."></div>
            <div class="fg"><label class="fl"><span class="rq">*</span>Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© | Family Name</label><input id="mf" type="text" class="fc" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©..."></div>
          </div>
          <div class="fr2">
            <div class="fg"><label class="fl"><span class="rq">*</span>Ø±Ù‚Ù… Ø§Ù„ØªØ­Ù‚Ù‚ | Verification Number</label><input id="mv" type="text" class="fc" placeholder="Ø±Ù‚Ù… Ø§Ù„ØªØ­Ù‚Ù‚..."></div>
            <div class="fg"><label class="fl"><span class="rq">*</span>Ø§Ù„Ù…Ù†ØµØ¨ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ | Requested Position</label><input id="mr" type="text" class="fc" placeholder="Ø§Ù„Ù…Ù†ØµØ¨ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨..."></div>
          </div>
          <div class="fg"><label class="fl"><span class="rq">*</span>Ø§Ù„Ø¹Ù†ÙˆØ§Ù† | Address</label><input id="ma" type="text" class="fc" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙƒØ§Ù…Ù„..."></div>
          <div class="fg"><label class="fl"><span class="rq">*</span>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ | Email</label><input id="me" type="email" class="fc" placeholder="example@email.com" dir="ltr"></div>
          <div class="fr2">
            <div class="fg"><label class="fl">ğŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ®</label><input id="md" type="text" class="fc" readonly style="background:rgba(255,255,255,.02);cursor:default;"></div>
            <div class="fg"><label class="fl">ğŸ• Ø§Ù„ÙˆÙ‚Øª</label><input id="mt" type="text" class="fc" readonly style="background:rgba(255,255,255,.02);cursor:default;"></div>
          </div>
          <div id="me1" class="al al-err" style="display:none;"><i class="fas fa-exclamation-circle"></i><span></span></div>
          <button id="msub-btn" class="btn btn-teal btn-w" onclick="msub()"><i class="fas fa-paper-plane"></i> Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø¹Ø¶ÙˆÙŠØ©</button>
        </div>
      </div>
    </div>

    <div id="msuccess" style="display:none;">
      <div class="success-card" style="border-color:rgba(26,188,156,.25);">
        <div style="font-size:3.8rem;margin-bottom:.8rem;">ğŸŒŸ</div>
        <h2 style="font-family:'Amiri',serif;font-size:1.9rem;color:#76d7c4;margin-bottom:.3rem;">ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø¹Ø¶ÙˆÙŠØ© Ø¨Ù†Ø¬Ø§Ø­!</h2>
        <p style="color:var(--tx2);font-size:.86rem;margin-bottom:.5rem;">Membership request submitted successfully</p>
        <div class="success-id" id="msid" style="color:#76d7c4;border-color:rgba(26,188,156,.22);background:rgba(26,188,156,.08);"></div>
        <p style="color:var(--tx3);font-size:.79rem;margin-bottom:2rem;">ÙŠÙ…ÙƒÙ†Ùƒ Ù…ØªØ§Ø¨Ø¹Ø© Ø­Ø§Ù„Ø© Ø·Ù„Ø¨Ùƒ Ù…Ù† Ø®Ù„Ø§Ù„ ØµÙØ­Ø© Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©</p>
        <div style="display:flex;gap:9px;justify-content:center;flex-wrap:wrap;">
          <button class="btn btn-teal" onclick="nav('track')"><i class="fas fa-search"></i> Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø·Ù„Ø¨</button>
          <button class="btn btn-ghost" onclick="mreset();nav('home')"><i class="fas fa-home"></i> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     TRACK PAGE (by tracking number)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="view-track" class="view">
  <header class="hdr">
    <div class="logo" onclick="nav('home')">
      <div class="logo-mark">ğŸ”</div>
      <div class="logo-text"><h1>Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h1><span>Track Applications</span></div>
    </div>
    <div class="hdr-right">
      <button class="btn btn-ghost btn-sm" onclick="nav('home')"><i class="fas fa-home"></i> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
    </div>
  </header>

  <div class="con" style="max-width:700px;">
    <div style="margin-top:1.5rem;">
      <div class="search-hero">
        <h2 style="color:var(--wh);">ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† Ø·Ù„Ø¨Ùƒ</h2>
        <p>Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ù„Ù…Ø´Ø§Ù‡Ø¯Ø© Ø­Ø§Ù„ØªÙ‡</p>
        <div class="search-box">
          <input type="text" id="tk" class="fc" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨..." onkeydown="if(event.key==='Enter')doTrack()" dir="ltr" style="text-align:center;letter-spacing:1px;">
          <button class="btn btn-gold" onclick="doTrack()"><i class="fas fa-search"></i> Ø¨Ø­Ø«</button>
        </div>
      </div>
      <div id="tk-res"></div>
      <div id="tk-empty" style="display:none;">
        <div class="empty"><i class="fas fa-search"></i><p>Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø·Ù„Ø¨ Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø±Ù‚Ù…</p></div>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ADMIN LOGIN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="view-login" class="view">
  <div class="login-wrap">
    <div class="login-box">
      <div class="login-head">
        <div class="moon">ğŸŒ™</div>
        <h2>Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h2>
        <p>Admin Panel â€” Authorized Access Only</p>
      </div>
      <div class="login-body">
        <div class="fg"><label class="fl"><i class="fas fa-user"></i> Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label><input type="text" id="lu" class="fc" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢" autocomplete="off"></div>
        <div class="fg">
          <label class="fl"><i class="fas fa-lock"></i> ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
          <input type="password" id="lp" class="fc" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" onkeydown="if(event.key==='Enter')doLogin()">
        </div>
        <div id="lerr" class="al al-err" style="display:none;"><i class="fas fa-times-circle"></i><span>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­Ø©</span></div>
        <button class="btn btn-gold btn-w" onclick="doLogin()"><i class="fas fa-sign-in-alt"></i> Ø¯Ø®ÙˆÙ„</button>
        <button class="btn btn-ghost btn-w" style="margin-top:8px;" onclick="nav('home')"><i class="fas fa-arrow-right"></i> Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ADMIN DASHBOARD
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="view-admin" class="view">
  <header class="hdr">
    <div class="logo">
      <div class="logo-mark">âš™ï¸</div>
      <div class="logo-text"><h1>Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h1><span>Admin Control Panel</span></div>
    </div>
    <div class="hdr-right">
      <span style="font-size:.75rem;color:var(--g2);display:flex;align-items:center;gap:5px;">
        <span style="width:8px;height:8px;border-radius:50%;background:#2ecc71;display:inline-block;box-shadow:0 0 8px #2ecc71;animation:pulse 2s infinite;"></span>
      </span>
      <button class="btn btn-red btn-sm" onclick="doLogout()"><i class="fas fa-sign-out-alt"></i> Ø®Ø±ÙˆØ¬</button>
    </div>
  </header>

  <div class="admin-layout">
    <nav class="sidebar">
      <div class="sb-logo"><div class="dot"></div><span>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</span></div>
      <div class="sb-nav">
        <div class="sb-section">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
        <div class="sb-item act" onclick="aSec('overview',this)"><i class="fas fa-chart-pie"></i> Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© <span class="sb-badge" id="sb-tot">0</span></div>
        <div class="sb-section">Ø§Ù„Ø·Ù„Ø¨Ø§Øª</div>
        <div class="sb-item" onclick="aSec('all',this)"><i class="fas fa-list"></i> Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª <span class="sb-badge" id="sb-all2">0</span></div>
        <div class="sb-item" onclick="aSec('verif',this)"><i class="fas fa-shield-alt"></i> Ø·Ù„Ø¨Ø§Øª Ø§Ù„ØªØ­Ù‚Ù‚ <span class="sb-badge" id="sb-v">0</span></div>
        <div class="sb-item" onclick="aSec('memb',this)"><i class="fas fa-id-card"></i> Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¹Ø¶ÙˆÙŠØ© <span class="sb-badge" id="sb-m">0</span></div>
        <div class="sb-section">Ø§Ù„Ø­Ø§Ù„Ø§Øª</div>
        <div class="sb-item" onclick="aSec('pend',this)"><i class="fas fa-clock"></i> Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± <span class="sb-badge" id="sb-p">0</span></div>
        <div class="sb-item" onclick="aSec('proc',this)"><i class="fas fa-cog fa-spin" style="animation-duration:3s;"></i> Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© <span class="sb-badge" id="sb-pr">0</span></div>
        <div class="sb-item" onclick="aSec('done',this)"><i class="fas fa-check-circle"></i> Ù…ÙƒØªÙ…Ù„Ø© <span class="sb-badge" id="sb-c">0</span></div>
        <div class="sb-item" onclick="aSec('rej',this)"><i class="fas fa-times-circle"></i> Ù…Ø±ÙÙˆØ¶Ø© <span class="sb-badge" id="sb-r">0</span></div>
      </div>
      <div class="sb-bottom">
        <button class="btn btn-ghost btn-sm" style="width:100%;" onclick="renderAdmin()"><i class="fas fa-sync-alt"></i> ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
        <button class="btn btn-ghost btn-sm" style="width:100%;margin-top:6px;" onclick="nav('home')"><i class="fas fa-external-link-alt"></i> Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¹Ø§Ù…</button>
      </div>
    </nav>

    <main class="admin-main">
      <!-- OVERVIEW -->
      <div id="sec-overview" class="a-section act">
        <div class="admin-topbar">
          <div><h2>Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©</h2><p>Overview Dashboard</p></div>
          <div style="display:flex;gap:8px;flex-wrap:wrap;">
            <button class="btn btn-ghost btn-sm" onclick="renderAdmin()"><i class="fas fa-sync-alt"></i> ØªØ­Ø¯ÙŠØ«</button>
            <button class="btn btn-gold btn-sm" onclick="openPdfModal()"><i class="fas fa-file-pdf"></i> ØªØµØ¯ÙŠØ± ØªÙ‚Ø±ÙŠØ± PDF</button>
          </div>
        </div>
        <div class="con-w">
          <div class="stats-grid">
            <div class="stat-card"><div class="stat-icon-wrap" style="background:rgba(201,168,76,.12);"><i class="fas fa-folder-open" style="color:var(--g1);"></i></div><div class="stat-num" id="ov-tot" style="color:var(--g1);">0</div><div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</div></div>
            <div class="stat-card"><div class="stat-icon-wrap" style="background:rgba(155,89,182,.12);"><i class="fas fa-shield-alt" style="color:#c39bd3;"></i></div><div class="stat-num" id="ov-v" style="color:#c39bd3;">0</div><div class="stat-label">Ø·Ù„Ø¨Ø§Øª Ø§Ù„ØªØ­Ù‚Ù‚</div></div>
            <div class="stat-card"><div class="stat-icon-wrap" style="background:rgba(26,188,156,.12);"><i class="fas fa-id-card" style="color:#76d7c4;"></i></div><div class="stat-num" id="ov-m" style="color:#76d7c4;">0</div><div class="stat-label">Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¹Ø¶ÙˆÙŠØ©</div></div>
            <div class="stat-card"><div class="stat-icon-wrap" style="background:rgba(243,156,18,.12);"><i class="fas fa-clock" style="color:#f5b041;"></i></div><div class="stat-num" id="ov-p" style="color:#f5b041;">0</div><div class="stat-label">Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</div></div>
            <div class="stat-card"><div class="stat-icon-wrap" style="background:rgba(52,152,219,.12);"><i class="fas fa-cog" style="color:#5dade2;"></i></div><div class="stat-num" id="ov-pr" style="color:#5dade2;">0</div><div class="stat-label">Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©</div></div>
            <div class="stat-card"><div class="stat-icon-wrap" style="background:rgba(46,204,113,.12);"><i class="fas fa-check-circle" style="color:#58d68d;"></i></div><div class="stat-num" id="ov-c" style="color:#58d68d;">0</div><div class="stat-label">Ù…ÙƒØªÙ…Ù„Ø©</div></div>
            <div class="stat-card"><div class="stat-icon-wrap" style="background:rgba(231,76,60,.12);"><i class="fas fa-times-circle" style="color:#ec7063;"></i></div><div class="stat-num" id="ov-r" style="color:#ec7063;">0</div><div class="stat-label">Ù…Ø±ÙÙˆØ¶Ø©</div></div>
          </div>
          <div class="card">
            <div class="card-hd"><div class="cic"><i class="fas fa-history"></i></div><div><h3>Ø£Ø­Ø¯Ø« Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h3><span>Recent Requests</span></div></div>
            <div class="card-b" style="padding:0;">
              <div class="table-wrap">
                <table>
                  <thead><tr><th>Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</th><th>Ø§Ù„Ù†ÙˆØ¹</th><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th><th>Ø¥Ø¬Ø±Ø§Ø¡</th></tr></thead>
                  <tbody id="recent-tb"></tbody>
                </table>
                <div id="recent-empty" class="empty" style="display:none;"><i class="fas fa-inbox"></i><p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø¨Ø¹Ø¯</p></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ALL TABLE -->
      <div id="sec-all" class="a-section">
        <div class="admin-topbar">
          <div><h2 id="sec-title">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h2><p id="sec-sub">All Requests</p></div>
          <button class="btn btn-gold btn-sm" onclick="exportCurrentTablePdf()"><i class="fas fa-file-pdf"></i> ØªØµØ¯ÙŠØ± PDF</button>
        </div>
        <div class="con-w">
          <div class="filter-bar">
            <input type="text" id="asearch" class="fc" placeholder="ğŸ” Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨..." oninput="renderTable()">
            <div class="chip-grp">
              <div class="chip on" id="chip-all" onclick="chipF('all')">Ø§Ù„ÙƒÙ„</div>
              <div class="chip" id="chip-verif" onclick="chipF('verif')">ğŸ” ØªØ­Ù‚Ù‚</div>
              <div class="chip" id="chip-memb" onclick="chipF('memb')">ğŸªª Ø¹Ø¶ÙˆÙŠØ©</div>
            </div>
          </div>
          <div class="card">
            <div class="card-b" style="padding:0;">
              <div class="table-wrap">
                <table>
                  <thead><tr><th>Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</th><th>Ø§Ù„Ù†ÙˆØ¹</th><th>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</th><th>Ø§Ù„Ù…Ù†ØµØ¨ / Ø±Ù‚Ù… Ø§Ù„ØªØ­Ù‚Ù‚</th><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th><th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th></tr></thead>
                  <tbody id="main-tb"></tbody>
                </table>
                <div id="main-empty" class="empty" style="display:none;"><i class="fas fa-inbox"></i><p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„ÙØ¦Ø©</p></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div id="sec-verif" class="a-section"></div>
      <div id="sec-memb" class="a-section"></div>
      <div id="sec-pend" class="a-section"></div>
      <div id="sec-proc" class="a-section"></div>
      <div id="sec-done" class="a-section"></div>
      <div id="sec-rej" class="a-section"></div>
    </main>
  </div>
</div>

</div><!-- #root -->

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• PDF EXPORT MODAL â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="overlay" id="ov-pdf">
  <div class="modal" style="max-width:460px;">
    <div class="mhd"><h3><i class="fas fa-file-pdf" style="color:#e74c3c;margin-left:7px;"></i> ØªØµØ¯ÙŠØ± ØªÙ‚Ø±ÙŠØ± PDF</h3><button class="mcl" onclick="cM('ov-pdf')"><i class="fas fa-times"></i></button></div>
    <div class="mbd">
      <div class="fg">
        <label class="fl">Ù†ÙˆØ¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ±</label>
        <select id="pdf-type" class="fc">
          <option value="all">ğŸ“‹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</option>
          <option value="verif">ğŸ” Ø·Ù„Ø¨Ø§Øª Ø§Ù„ØªØ­Ù‚Ù‚ ÙÙ‚Ø·</option>
          <option value="memb">ğŸªª Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¹Ø¶ÙˆÙŠØ© ÙÙ‚Ø·</option>
          <option value="pending">â³ Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</option>
          <option value="processing">ğŸ”„ Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©</option>
          <option value="completed">âœ… Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©</option>
          <option value="rejected">âŒ Ø§Ù„Ù…Ø±ÙÙˆØ¶Ø©</option>
        </select>
      </div>
      <div class="fg">
        <label class="fl">ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªÙ‚Ø±ÙŠØ±</label>
        <select id="pdf-detail" class="fc">
          <option value="summary">Ù…Ù„Ø®Øµ (Ø¬Ø¯ÙˆÙ„ Ù…ÙˆØ¬Ø²)</option>
          <option value="full">ØªÙØµÙŠÙ„ÙŠ (Ø¨ÙŠØ§Ù†Ø§Øª ÙƒØ§Ù…Ù„Ø©)</option>
        </select>
      </div>
      <div class="fg">
        <label class="fl">ØªØ±ØªÙŠØ¨ Ø­Ø³Ø¨</label>
        <select id="pdf-sort" class="fc">
          <option value="date-desc">Ø§Ù„Ø£Ø­Ø¯Ø« Ø£ÙˆÙ„Ø§Ù‹</option>
          <option value="date-asc">Ø§Ù„Ø£Ù‚Ø¯Ù… Ø£ÙˆÙ„Ø§Ù‹</option>
          <option value="status">Ø§Ù„Ø­Ø§Ù„Ø©</option>
          <option value="name">Ø§Ù„Ø§Ø³Ù…</option>
        </select>
      </div>
      <div style="background:rgba(201,168,76,.06);border:1px solid var(--brd);border-radius:9px;padding:.9rem 1rem;font-size:.8rem;color:var(--tx2);line-height:1.8;">
        <i class="fas fa-info-circle" style="color:var(--g1);margin-left:5px;"></i>
        Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù PDF ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø®ØªØ§Ø±Ø© Ù…Ø¹ Ø®ØªÙ… Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø±Ø³Ù…ÙŠ ÙˆØ§Ù„ØªØ§Ø±ÙŠØ®
      </div>
    </div>
    <div class="mft">
      <button class="btn btn-ghost btn-sm" onclick="cM('ov-pdf')">Ø¥Ù„ØºØ§Ø¡</button>
      <button class="btn btn-red btn-sm" onclick="generatePdf()"><i class="fas fa-download"></i> Ø¥Ù†Ø´Ø§Ø¡ ÙˆØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚Ø±ÙŠØ±</button>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• MODALS â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="overlay" id="ov-view">
  <div class="modal modal-lg">
    <div class="mhd"><h3><i class="fas fa-eye" style="color:var(--g1);margin-left:7px;"></i> ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨</h3><button class="mcl" onclick="cM('ov-view')"><i class="fas fa-times"></i></button></div>
    <div class="mbd" id="view-body"></div>
    <div class="mft"><button class="btn btn-ghost btn-sm" onclick="cM('ov-view')"><i class="fas fa-times"></i> Ø¥ØºÙ„Ø§Ù‚</button></div>
  </div>
</div>

<div class="overlay" id="ov-rej">
  <div class="modal">
    <div class="mhd"><h3><i class="fas fa-ban" style="color:#e74c3c;margin-left:7px;"></i> Ø±ÙØ¶ Ø§Ù„Ø·Ù„Ø¨</h3><button class="mcl" onclick="cM('ov-rej')"><i class="fas fa-times"></i></button></div>
    <div class="mbd">
      <p style="color:var(--tx2);margin-bottom:.9rem;font-size:.86rem;">Ø£Ø¯Ø®Ù„ Ø³Ø¨Ø¨ Ø§Ù„Ø±ÙØ¶ (Ø³ÙŠØ¸Ù‡Ø± Ù„Ù„Ù…ØªÙ‚Ø¯Ù…):</p>
      <input type="text" id="rjr" class="fc" placeholder="Ø³Ø¨Ø¨ Ø§Ù„Ø±ÙØ¶...">
    </div>
    <div class="mft">
      <button class="btn btn-ghost btn-sm" onclick="cM('ov-rej')">Ø¥Ù„ØºØ§Ø¡</button>
      <button class="btn btn-red btn-sm" onclick="confRej()"><i class="fas fa-ban"></i> ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø±ÙØ¶</button>
    </div>
  </div>
</div>

<div class="overlay" id="ov-edit">
  <div class="modal modal-lg">
    <div class="mhd"><h3><i class="fas fa-edit" style="color:var(--g1);margin-left:7px;"></i> ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨</h3><button class="mcl" onclick="cM('ov-edit')"><i class="fas fa-times"></i></button></div>
    <div class="mbd">
      <div id="edit-f"></div>
      <div class="fg">
        <label class="fl">Ø§Ù„Ø­Ø§Ù„Ø© | Status</label>
        <select id="e-st" class="fc">
          <option value="pending">â³ Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</option>
          <option value="processing">ğŸ”„ Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©</option>
          <option value="completed">âœ… Ù…ÙƒØªÙ…Ù„</option>
          <option value="rejected">âŒ Ù…Ø±ÙÙˆØ¶</option>
        </select>
      </div>
      <div class="fg" style="margin-top:.8rem;">
        <label class="fl"><i class="fas fa-file-pdf" style="color:#e74c3c;margin-left:4px;"></i> Ø¥Ø±ÙØ§Ù‚ ÙˆØ«ÙŠÙ‚Ø© PDF Ù„Ù„Ø·Ù„Ø¨ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
        <p style="font-size:.72rem;color:var(--tx3);margin-bottom:6px;">Ø³ÙŠØªÙ…ÙƒÙ† Ù…Ù‚Ø¯Ù… Ø§Ù„Ø·Ù„Ø¨ Ù…Ù† ØªØ­Ù…ÙŠÙ„ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù Ø¹Ù†Ø¯ Ø­Ø§Ù„Ø© "Ù…ÙƒØªÙ…Ù„"</p>
        <div class="upz" style="padding:1.2rem;" onclick="document.getElementById('admin-pdf-inp').click()">
          <input type="file" id="admin-pdf-inp" accept=".pdf" style="display:none;" onchange="handleAdminPdf(this)">
          <div class="upz-icon" style="font-size:1.5rem;">ğŸ“„</div>
          <p style="font-size:.82rem;">Ø§Ù†Ù‚Ø± Ù„Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù PDF</p>
          <small>PDF ÙÙ‚Ø· â€” Ø£Ù‚ØµÙ‰ Ø­Ø¬Ù… 5MB</small>
        </div>
        <div id="admin-pdf-preview" style="display:none;margin-top:.6rem;padding:9px 13px;background:rgba(231,76,60,.08);border:1px solid rgba(231,76,60,.2);border-radius:8px;font-size:.82rem;color:#f1948a;">
          <i class="fas fa-file-pdf" style="margin-left:6px;"></i>
          <span id="admin-pdf-name"></span>
          <button onclick="clearAdminPdf()" style="background:none;border:none;color:#e74c3c;cursor:pointer;margin-right:8px;font-size:.75rem;">âœ• Ø¥Ø²Ø§Ù„Ø©</button>
        </div>
        <div id="admin-pdf-existing" style="display:none;margin-top:.6rem;padding:9px 13px;background:rgba(46,204,113,.08);border:1px solid rgba(46,204,113,.2);border-radius:8px;font-size:.82rem;color:#58d68d;">
          <i class="fas fa-check-circle" style="margin-left:6px;"></i> ÙŠÙˆØ¬Ø¯ Ù…Ù„Ù PDF Ù…Ø±ÙÙ‚ Ù…Ø³Ø¨Ù‚Ø§Ù‹
          <span id="admin-pdf-existing-name" style="color:var(--tx2);font-size:.75rem;margin-right:6px;"></span>
          <button onclick="removeExistingAdminPdf()" style="background:none;border:none;color:#e74c3c;cursor:pointer;font-size:.75rem;">âœ• Ø­Ø°Ù Ø§Ù„Ù…Ù„Ù</button>
        </div>
      </div>
    </div>
    <div class="mft">
      <button class="btn btn-ghost btn-sm" onclick="cM('ov-edit')">Ø¥Ù„ØºØ§Ø¡</button>
      <button class="btn btn-green btn-sm" onclick="saveEd()"><i class="fas fa-save"></i> Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª</button>
    </div>
  </div>
</div>

<style>
@keyframes pulse{0%,100%{opacity:1;}50%{opacity:.5;}}
</style>

<script>
'use strict';

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  DATABASE CONFIGURATION â€” set FIREBASE_URL below
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const FIREBASE_URL = 'https://verification-system-50962-default-rtdb.asia-southeast1.firebasedatabase.app';

const isFirebaseReady = () => FIREBASE_URL !== 'YOUR_FIREBASE_URL_HERE' && FIREBASE_URL.startsWith('https://');

// â”€â”€ FIREBASE REST API â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const FB = {
  async getAll() {
    if (!isFirebaseReady()) {
      // Fallback to localStorage if Firebase not set up
      return JSON.parse(localStorage.getItem('vms_bkp')||'[]');
    }
    try {
      const r = await fetch(FIREBASE_URL + '/requests.json');
      const data = await r.json();
      if (!data) return [];
      return Object.entries(data)
        .map(([key, val]) => ({ ...val, _key: key }))
        .sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
    } catch(e) {
      console.error('Firebase read error:', e);
      return JSON.parse(localStorage.getItem('vms_bkp')||'[]');
    }
  },
  async add(record) {
    if (!isFirebaseReady()) {
      const db = JSON.parse(localStorage.getItem('vms_bkp')||'[]');
      db.unshift(record);
      localStorage.setItem('vms_bkp', JSON.stringify(db));
      return { name: record.id };
    }
    try {
      const r = await fetch(FIREBASE_URL + '/requests.json', {
        method: 'POST',
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify(record)
      });
      return await r.json();
    } catch(e) {
      console.error('Firebase write error:', e);
      throw e;
    }
  },
  async update(key, data) {
    if (!isFirebaseReady()) {
      const db = JSON.parse(localStorage.getItem('vms_bkp')||'[]');
      const i = db.findIndex(x => x.id === key || x._key === key);
      if (i >= 0) { Object.assign(db[i], data); localStorage.setItem('vms_bkp', JSON.stringify(db)); }
      return data;
    }
    try {
      const r = await fetch(FIREBASE_URL + '/requests/' + key + '.json', {
        method: 'PATCH',
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify(data)
      });
      return await r.json();
    } catch(e) { console.error('Firebase update error:', e); }
  },
  async delete(key) {
    if (!isFirebaseReady()) {
      let db = JSON.parse(localStorage.getItem('vms_bkp')||'[]');
      db = db.filter(x => x.id !== key && x._key !== key);
      localStorage.setItem('vms_bkp', JSON.stringify(db));
      return;
    }
    try {
      await fetch(FIREBASE_URL + '/requests/' + key + '.json', { method: 'DELETE' });
    } catch(e) { console.error('Firebase delete error:', e); }
  }
};

// â”€â”€ CONSTANTS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const AU = 'admin', AP = 'ChieF@2024#Admin!Secure$786';
const VIEWS = ['home','verif','memb','track','login','admin'];
let DB = []; // In-memory cache
let curSec = 'all', curChip = 'all', curRjId = null, curEdId = null;
const uid = p => p + '-' + Date.now().toString(36).toUpperCase().substr(-4) + Math.random().toString(36).substr(2,3).toUpperCase();
const esc = s => (s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
const show = id => document.getElementById(id).style.display='flex';
const hide = id => document.getElementById(id).style.display='none';

// â”€â”€ LOADING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const showLoad = () => document.getElementById('loading').classList.add('show');
const hideLoad = () => document.getElementById('loading').classList.remove('show');

// â”€â”€ ROUTER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function nav(v) {
  const veil = document.getElementById('page-veil');
  veil.classList.add('in');
  await delay(200);

  VIEWS.forEach(x => {
    const el = document.getElementById('view-'+x);
    el.classList.remove('show');
    el.style.display = 'none';
  });

  const el = document.getElementById('view-'+v);
  el.style.display = 'flex';

  await delay(30);
  veil.classList.remove('in');
  await delay(10);
  el.classList.add('show');

  window.scrollTo({top:0, behavior:'instant'});
  history.replaceState(null, '', '#/'+v);

  if (v === 'admin') await renderAdmin();
  if (v === 'track') {
    document.getElementById('tk').value = '';
    document.getElementById('tk-res').innerHTML = '';
    hide('tk-empty');
  }
  if (v === 'verif') { updDT('v'); vstep(1); }
  if (v === 'memb') { updDT('m'); }
}

const delay = ms => new Promise(r => setTimeout(r, ms));

// â”€â”€ INIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
window.addEventListener('load', () => {
  // Generate star particles
  const sf = document.getElementById('star-field');
  for (let i = 0; i < 60; i++) {
    const s = document.createElement('div');
    s.className = 'star';
    const size = Math.random() * 2.5 + 1;
    s.style.cssText = `width:${size}px;height:${size}px;top:${Math.random()*100}%;left:${Math.random()*100}%;animation-delay:${Math.random()*4}s;animation-duration:${2+Math.random()*4}s;`;
    sf.appendChild(s);
  }

  VIEWS.forEach(x => {
    const el = document.getElementById('view-'+x);
    el.style.display = 'none';
    el.classList.remove('show');
  });
  handleHash();
  updDT('v'); updDT('m');
  setInterval(() => { updDT('v'); updDT('m'); }, 1000);
});

function handleHash() {
  const h = location.hash.replace('#/','');
  if (h === 'admin') {
    document.getElementById('lerr').style.display = 'none';
    nav('login'); return;
  }
  if (VIEWS.includes(h)) nav(h); else nav('home');
}
window.addEventListener('hashchange', handleHash);

// â”€â”€ DATE/TIME â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function updDT(p) {
  const n = new Date();
  const di = document.getElementById(p+'d'); if(di) di.value = n.toLocaleDateString('ar-SA',{year:'numeric',month:'long',day:'numeric'});
  const ti = document.getElementById(p+'t'); if(ti) ti.value = n.toLocaleTimeString('ar-SA');
}

// â”€â”€ AUTH â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function doLogin() {
  const u = document.getElementById('lu').value.trim();
  const p = document.getElementById('lp').value;
  if (u === AU && p === AP) {
    hide('lerr');
    document.getElementById('lu').value = '';
    document.getElementById('lp').value = '';
    nav('admin');
  } else {
    const err = document.getElementById('lerr');
    err.style.display = 'flex';
    err.style.animation = 'none';
    setTimeout(() => err.style.animation = '', 10);
  }
}
function doLogout() { nav('home'); }

// â”€â”€ COMPRESS IMAGE (aggressive, mobile-safe) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function compressImage(dataUrl, maxPx, quality) {
  return new Promise((resolve) => {
    const img = new Image();
    img.onload = () => {
      let w = img.width, h = img.height;
      if (w > maxPx) { h = Math.round(h * maxPx / w); w = maxPx; }
      if (h > maxPx) { w = Math.round(w * maxPx / h); h = maxPx; }
      const c = document.createElement('canvas');
      c.width = w; c.height = h;
      c.getContext('2d').drawImage(img, 0, 0, w, h);
      try { resolve(c.toDataURL('image/jpeg', quality)); }
      catch(e) { resolve(dataUrl); } // fallback: return original
    };
    img.onerror = () => resolve(dataUrl);
    img.src = dataUrl;
  });
}

function readFile(file) {
  return new Promise((resolve, reject) => {
    const fr = new FileReader();
    fr.onload = e => resolve(e.target.result);
    fr.onerror = () => reject(new Error('ÙØ´Ù„ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù'));
    fr.readAsDataURL(file);
  });
}

async function processFile(file, isImage) {
  if (!file) return null;
  try {
    const dataUrl = await readFile(file);
    if (!isImage) {
      // PDF or non-image: store only if small enough, else store name only
      if (file.size <= 800 * 1024) {
        return { data: dataUrl, name: file.name, type: file.type, size: file.size };
      } else {
        return { data: null, name: file.name, type: file.type, size: file.size, tooLarge: true };
      }
    }
    // Image: compress in 2 passes to guarantee small size
    let compressed = await compressImage(dataUrl, 500, 0.55);
    // If still too large, compress again harder
    if (compressed.length > 150000) {
      compressed = await compressImage(compressed, 350, 0.45);
    }
    return { data: compressed, name: file.name, type: file.type, size: Math.round(compressed.length * 0.75) };
  } catch(e) {
    return { data: null, name: file.name, type: file.type, size: file.size, error: e.message };
  }
}

function hf(inp, prvId, nmId, showImg) {
  const f = document.getElementById(inp).files[0]; if (!f) return;
  const ext = f.name.split('.').pop().toLowerCase();
  const ok = showImg ? ['jpg','jpeg','png'] : ['pdf','jpg','jpeg'];
  if (!ok.includes(ext)) { alert('Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ù ØºÙŠØ± Ù…Ø³Ù…ÙˆØ­. Ø§Ù„Ù…Ù‚Ø¨ÙˆÙ„: '+ok.join(', ')); document.getElementById(inp).value=''; return; }
  const prv = document.getElementById(prvId); const nm = document.getElementById(nmId);
  if (nm) nm.textContent = 'âœ… ' + f.name;
  prv.style.display = 'block';
  if (showImg) {
    const r = new FileReader();
    r.onload = e => { const i = document.getElementById(prvId+'-img'); if(i) i.src = e.target.result; };
    r.readAsDataURL(f);
  }
}

// â”€â”€ VERIFICATION FORM â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function vstep(n) {
  [1,2,3].forEach(i => { document.getElementById('vp'+i).style.display = (i===n?'block':'none'); });
  [1,2,3].forEach(i => {
    const s = document.getElementById('vs'+i);
    s.classList.remove('on','ok');
    if (i < n) s.classList.add('ok');
    else if (i === n) s.classList.add('on');
  });
  [1,2].forEach(i => { const b = document.getElementById('vb'+i); if(b) b.className = 'sbar'+(i<n?' ok':''); });
  window.scrollTo({top:0, behavior:'smooth'});
}

function vNext() {
  const nm = document.getElementById('vn').value.trim();
  const ps = document.getElementById('vpos').value.trim();
  const ad = document.getElementById('va').value.trim();
  const ln = document.getElementById('vl').value.trim();
  const er = document.getElementById('ve1');
  if (!nm||!ps||!ad||!ln) { er.style.display='flex'; er.querySelector('span').textContent='ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©'; return; }
  er.style.display = 'none'; vstep(2);
}

async function vsub() {
  const p1 = document.getElementById('vf1').files[0];
  const p2 = document.getElementById('vf2').files[0];
  const er = document.getElementById('ve2');
  if (!p1||!p2) { er.style.display='flex'; er.querySelector('span').textContent='ÙŠØ±Ø¬Ù‰ Ø±ÙØ¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©'; return; }
  er.style.display = 'none';
  // Prevent double submission
  const subBtn = document.getElementById('vsub-btn');
  if (subBtn) { subBtn.disabled = true; subBtn.style.opacity = '0.6'; }
  showLoad();

  const id = uid('VR');
  // Step 1: Submit text data FIRST â€” guaranteed to work
  const record = {
    id, type:'verif',
    fullname: document.getElementById('vn').value.trim(),
    position: document.getElementById('vpos').value.trim(),
    address: document.getElementById('va').value.trim(),
    lineage: document.getElementById('vl').value.trim(),
    date: document.getElementById('vd').value,
    time: document.getElementById('vt').value,
    photoName: p1.name,
    linDocName: p2.name,
    photo: null,
    linDoc: null,
    status: 'pending', rejectReason: '',
    createdAt: new Date().toISOString()
  };

  try {
    await FB.add(record);
  } catch(e) {
    hideLoad();
    if (subBtn) { subBtn.disabled = false; subBtn.style.opacity = ''; }
    er.style.display = 'flex';
    er.querySelector('span').textContent = 'ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: ' + (e.message || 'ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª ÙˆØ­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰');
    return;
  }

  // Show success immediately â€” form is submitted
  DB.unshift(record);
  document.getElementById('vsid').textContent = id;
  vstep(3);
  hideLoad();
  if (subBtn) { subBtn.disabled = false; subBtn.style.opacity = ''; }

  // Step 2: Try to upload files silently in background
  try {
    const [f1data, f2data] = await Promise.all([
      processFile(p1, true),
      processFile(p2, p2.type !== 'application/pdf')
    ]);
    if (f1data || f2data) {
      const key = record._key || id;
      await FB.update(key, { photo: f1data, linDoc: f2data });
      record.photo = f1data; record.linDoc = f2data;
    }
  } catch(e) {
    // Silent fail â€” form already submitted, files just won't show in admin
    console.warn('File upload background failed:', e);
  }
}

function vreset() {
  ['vn','vpos','va','vl'].forEach(x => document.getElementById(x).value='');
  ['vf1','vf2'].forEach(x => document.getElementById(x).value='');
  document.getElementById('upv1').style.display = 'none';
  document.getElementById('upv2').style.display = 'none';
  vstep(1);
}

// â”€â”€ MEMBERSHIP FORM â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function msub() {
  const fields = [['mn','Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„'],['mf','Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©'],['mv','Ø±Ù‚Ù… Ø§Ù„ØªØ­Ù‚Ù‚'],['mr','Ø§Ù„Ù…Ù†ØµØ¨ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨'],['ma','Ø§Ù„Ø¹Ù†ÙˆØ§Ù†'],['me','Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ']];
  const er = document.getElementById('me1');
  for (const [fid, lbl] of fields) {
    if (!document.getElementById(fid).value.trim()) { er.style.display='flex'; er.querySelector('span').textContent='Ø­Ù‚Ù„ "'+lbl+'" Ù…Ø·Ù„ÙˆØ¨'; return; }
  }
  const email = document.getElementById('me').value.trim();
  if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) { er.style.display='flex'; er.querySelector('span').textContent='ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØµØ­ÙŠØ­'; return; }
  er.style.display = 'none';
  const msubBtn = document.getElementById('msub-btn');
  if (msubBtn) { msubBtn.disabled = true; msubBtn.style.opacity = '0.6'; }
  showLoad();
  try {
    const id = uid('MB');
    const record = {
      id, type:'memb',
      fullname: document.getElementById('mn').value.trim(),
      familyName: document.getElementById('mf').value.trim(),
      verifNo: document.getElementById('mv').value.trim(),
      reqPosition: document.getElementById('mr').value.trim(),
      address: document.getElementById('ma').value.trim(),
      email,
      date: document.getElementById('md').value,
      time: document.getElementById('mt').value,
      status: 'pending', rejectReason: '',
      createdAt: new Date().toISOString()
    };
    await FB.add(record);
    DB.unshift(record);
    document.getElementById('msid').textContent = id;
    document.getElementById('mform').style.display = 'none';
    document.getElementById('msuccess').style.display = 'block';
    window.scrollTo({top:0, behavior:'smooth'});
  } catch(e) {
    er.style.display = 'flex';
    er.querySelector('span').textContent = 'ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: ' + (e.message || 'ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª ÙˆØ­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰');
  } finally { 
    hideLoad(); 
    const msubBtn2 = document.getElementById('msub-btn');
    if (msubBtn2) { msubBtn2.disabled = false; msubBtn2.style.opacity = ''; }
  }
}

function mreset() {
  ['mn','mf','mv','mr','ma','me'].forEach(x => document.getElementById(x).value='');
  document.getElementById('mform').style.display = 'block';
  document.getElementById('msuccess').style.display = 'none';
}



// â”€â”€ COPY TRACKING NUMBER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function copyId(elId, btnId) {
  const txt = document.getElementById(elId).textContent;
  navigator.clipboard.writeText(txt).then(() => {
    const btn = document.getElementById(btnId);
    btn.innerHTML = '<i class="fas fa-check"></i> ØªÙ… Ø§Ù„Ù†Ø³Ø®!';
    btn.style.color = '#58d68d';
    setTimeout(() => { btn.innerHTML = '<i class="fas fa-copy"></i> Ù†Ø³Ø® Ø§Ù„Ø±Ù‚Ù…'; btn.style.color = ''; }, 2000);
  });
}

// â”€â”€ BADGES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const SM = {
  pending:    {l:'Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±', c:'b-pend', i:'â³'},
  processing: {l:'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©', c:'b-proc', i:'ğŸ”„'},
  completed:  {l:'Ù…ÙƒØªÙ…Ù„',        c:'b-done', i:'âœ…'},
  rejected:   {l:'Ù…Ø±ÙÙˆØ¶',        c:'b-rej',  i:'âŒ'}
};
const bSt = st => { const s = SM[st]||SM.pending; return `<span class="badge ${s.c}">${s.i} ${s.l}</span>`; };
const bTy = t => t==='verif' ? `<span class="badge b-vrf">ğŸ” ØªØ­Ù‚Ù‚</span>` : `<span class="badge b-mem">ğŸªª Ø¹Ø¶ÙˆÙŠØ©</span>`;

// â”€â”€ TRACK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function doTrack() {
  const raw = document.getElementById('tk').value.trim();
  const q = raw.toUpperCase();
  const res = document.getElementById('tk-res');
  const emp = document.getElementById('tk-empty');
  if (!q) { res.innerHTML = ''; emp.style.display = 'none'; return; }
  res.innerHTML = ''; emp.style.display = 'none';
  showLoad();

  let allData = [], fetchFailed = false;
  try { allData = await FB.getAll(); }
  catch(e) { fetchFailed = true; }
  finally { hideLoad(); }

  if (fetchFailed) {
    res.innerHTML = `<div class="al al-err"><i class="fas fa-wifi"></i><span>ØªØ¹Ø°Ù‘Ø± Ø§Ù„Ø§ØªØµØ§Ù„. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª ÙˆØ£Ø¹Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©.</span></div>`;
    return;
  }

  const found = allData.filter(r => r.id && r.id.toUpperCase().includes(q));
  if (!found.length) { emp.style.display = 'block'; return; }

  const statusDisplay = {
    pending:    { label:'Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±',  icon:'â³', cls:'b-pend', note:'' },
    processing: { label:'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©',  icon:'ğŸ”„', cls:'b-proc', note:'<div style="margin-top:.8rem;padding:9px 13px;background:rgba(52,152,219,.08);border:1px solid rgba(52,152,219,.2);border-radius:8px;font-size:.8rem;color:#5dade2;"><i class="fas fa-cog fa-spin"></i> ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨Ùƒ ÙˆÙ‡Ùˆ Ø§Ù„Ø¢Ù† Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆØ§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© â€” Ø³ÙŠØªÙ… Ø¥Ø¹Ù„Ø§Ù…Ùƒ Ø¹Ù†Ø¯ Ø§ÙƒØªÙ…Ø§Ù„Ù‡ Ø¹Ø¨Ø± Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</div>' },
    completed:  { label:'Ù…ÙƒØªÙ…Ù„ âœ“',       icon:'âœ…', cls:'b-done', note:'COMPLETED_NOTE' },
    rejected:   { label:'Ù…Ø±ÙÙˆØ¶',          icon:'âŒ', cls:'b-rej',  note:'' }
  };

  res.innerHTML = found.map((r, i) => {
    const st = statusDisplay[r.status] || statusDisplay.pending;
    // Build status note
    let statusNote = st.note;
    if (r.status === 'completed') {
      let dlBtn = '';
      if (r.adminPdf && r.adminPdf.data) {
        dlBtn = `<div style="margin-top:.7rem;">
          <a href="${r.adminPdf.data}" download="${esc(r.adminPdf.name||'document.pdf')}" class="btn btn-green btn-sm" style="display:inline-flex;gap:6px;">
            <i class="fas fa-download"></i> ØªØ­Ù…ÙŠÙ„ ÙˆØ«ÙŠÙ‚Ø© Ø§Ù„Ø·Ù„Ø¨
          </a>
        </div>`;
      }
      statusNote = `<div style="margin-top:.8rem;padding:9px 13px;background:rgba(46,204,113,.08);border:1px solid rgba(46,204,113,.2);border-radius:8px;font-size:.8rem;color:#58d68d;">
        <i class="fas fa-check-circle"></i> ØªÙ… Ù…Ø¹Ø§Ù„Ø¬Ø© Ø·Ù„Ø¨Ùƒ ÙˆØ§Ø¹ØªÙ…Ø§Ø¯Ù‡ Ø¨Ù†Ø¬Ø§Ø­ â€” ÙŠØ±Ø¬Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø£Ùˆ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙˆØ«ÙŠÙ‚Ø© Ø£Ø¯Ù†Ø§Ù‡
        ${dlBtn}
      </div>`;
    }
    return `<div class="rcard" style="animation-delay:${i*.07}s">
      <div class="rcard-top">
        <div style="display:flex;align-items:center;gap:7px;">${bTy(r.type)}<span style="font-family:monospace;color:var(--g1);font-size:.8rem;font-weight:700;">${esc(r.id)}</span></div>
        <span class="badge ${st.cls}">${st.icon} ${st.label}</span>
      </div>
      <div class="rcard-grid">
        <div><b>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„:</b> ${esc(r.fullname)}</div>
        <div><b>${r.type==='verif'?'Ø§Ù„Ù…Ù†ØµØ¨:':'Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©:'}</b> ${esc(r.type==='verif'?r.position:r.familyName)}</div>
        ${r.type==='memb'?`<div><b>Ø±Ù‚Ù… Ø§Ù„ØªØ­Ù‚Ù‚:</b> ${esc(r.verifNo)}</div><div><b>Ø§Ù„Ø¨Ø±ÙŠØ¯:</b> <span dir="ltr">${esc(r.email)}</span></div>`:''}
        <div><b>Ø§Ù„ØªØ§Ø±ÙŠØ®:</b> ${esc(r.date)}</div>
        <div><b>Ø§Ù„ÙˆÙ‚Øª:</b> ${esc(r.time)}</div>
      </div>
      ${r.status==='rejected'&&r.rejectReason?`<div class="rej-note"><i class="fas fa-exclamation-circle"></i> Ø³Ø¨Ø¨ Ø§Ù„Ø±ÙØ¶: ${esc(r.rejectReason)}</div>`:''}
      ${statusNote}
    </div>`;
  }).join('');
}

// â”€â”€ ADMIN RENDER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function renderAdmin() {
  showLoad();
  try {
    DB = await FB.getAll();
  } catch(e) { console.error(e); } finally { hideLoad(); }

  const tot=DB.length, v=DB.filter(r=>r.type==='verif').length, m=DB.filter(r=>r.type==='memb').length;
  const p=DB.filter(r=>r.status==='pending').length, pr=DB.filter(r=>r.status==='processing').length;
  const c=DB.filter(r=>r.status==='completed').length, rj=DB.filter(r=>r.status==='rejected').length;

  // Sidebar badges
  const badges = {tot,all2:tot,v,m,p,pr:pr,c,r:rj};
  Object.entries(badges).forEach(([k,val]) => { const el = document.getElementById('sb-'+k); if(el) el.textContent = val; });

  // Stats
  [['ov-tot',tot],['ov-v',v],['ov-m',m],['ov-p',p],['ov-pr',pr],['ov-c',c],['ov-r',rj]].forEach(([id,val]) => {
    const el = document.getElementById(id); if(el) el.textContent = val;
  });

  // Recent table
  const rtb = document.getElementById('recent-tb');
  const remp = document.getElementById('recent-empty');
  const recent = DB.slice(0, 8);
  if (!recent.length) { if(rtb) rtb.innerHTML=''; if(remp) remp.style.display='block'; }
  else {
    if(remp) remp.style.display='none';
    if(rtb) rtb.innerHTML = recent.map(r => `
      <tr>
        <td class="td-id">${esc(r.id)}</td>
        <td>${bTy(r.type)}</td>
        <td style="font-weight:600;max-width:160px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">${esc(r.fullname)}</td>
        <td style="font-size:.75rem;color:var(--tx2);">${esc(r.date)}</td>
        <td>${bSt(r.status)}</td>
        <td><button class="btn btn-blue btn-xs" onclick="viewR('${esc(r.id)}')"><i class="fas fa-eye"></i></button></td>
      </tr>`).join('');
  }
  renderTable();
}

let tableFilter = 'all', statusFilter = 'all';
function aSec(sec, el) {
  document.querySelectorAll('.sb-item').forEach(x => x.classList.remove('act'));
  if (el) el.classList.add('act');
  document.querySelectorAll('.a-section').forEach(x => x.classList.remove('act'));
  curSec = sec;
  if (sec === 'overview') { document.getElementById('sec-overview').classList.add('act'); return; }
  document.getElementById('sec-all').classList.add('act');
  const titles = {all:'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª',verif:'Ø·Ù„Ø¨Ø§Øª Ø§Ù„ØªØ­Ù‚Ù‚',memb:'Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¹Ø¶ÙˆÙŠØ©',pend:'Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±',proc:'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©',done:'Ù…ÙƒØªÙ…Ù„Ø©',rej:'Ù…Ø±ÙÙˆØ¶Ø©'};
  document.getElementById('sec-title').textContent = titles[sec]||'Ø§Ù„Ø·Ù„Ø¨Ø§Øª';
  if (sec==='verif'||sec==='memb') { tableFilter=sec; statusFilter='all'; chipF(sec,false); }
  else { tableFilter='all'; chipF('all',false); }
  const statusMap = {pend:'pending',proc:'processing',done:'completed',rej:'rejected'};
  statusFilter = statusMap[sec]||'all';
  renderTable();
}

function chipF(v, callRender=true) {
  tableFilter = v;
  document.querySelectorAll('.chip').forEach(c => c.classList.remove('on'));
  const c = document.getElementById('chip-'+v); if(c) c.classList.add('on');
  if (callRender) { statusFilter='all'; renderTable(); }
}

function renderTable() {
  const search = (document.getElementById('asearch')||{value:''}).value.trim().toLowerCase();
  let data = [...DB];
  if (tableFilter==='verif') data = data.filter(r => r.type==='verif');
  else if (tableFilter==='memb') data = data.filter(r => r.type==='memb');
  if (statusFilter && statusFilter!=='all') data = data.filter(r => r.status===statusFilter);
  if (search) data = data.filter(r => (r.fullname||'').toLowerCase().includes(search)||(r.id||'').toLowerCase().includes(search));
  const tb = document.getElementById('main-tb');
  const em = document.getElementById('main-empty');
  if (!data.length) { if(tb) tb.innerHTML=''; if(em) em.style.display='block'; return; }
  if(em) em.style.display='none';
  if(tb) tb.innerHTML = data.map(r => `
    <tr>
      <td class="td-id">${esc(r.id)}</td>
      <td>${bTy(r.type)}</td>
      <td style="font-weight:600;">${esc(r.fullname)}</td>
      <td style="font-size:.76rem;color:var(--tx2);">${esc(r.type==='verif'?r.position:r.verifNo)}</td>
      <td style="font-size:.75rem;color:var(--tx2);">${esc(r.date)}</td>
      <td>${bSt(r.status)}</td>
      <td>
        <div class="act-btns">
          <button class="btn btn-blue btn-xs" onclick="viewR('${esc(r.id)}')" title="Ø¹Ø±Ø¶"><i class="fas fa-eye"></i></button>
          <button class="btn btn-xs" style="background:rgba(52,152,219,.2);color:#5dade2;" onclick="setS('${esc(r.id)}','processing')" title="Ù…Ø¹Ø§Ù„Ø¬Ø©"><i class="fas fa-cog"></i></button>
          <button class="btn btn-xs" style="background:rgba(46,204,113,.2);color:#58d68d;" onclick="setS('${esc(r.id)}','completed')" title="Ø§Ø¹ØªÙ…Ø§Ø¯"><i class="fas fa-check"></i></button>
          <button class="btn btn-orange btn-xs" onclick="oRej('${esc(r.id)}')" title="Ø±ÙØ¶"><i class="fas fa-ban"></i></button>
          <button class="btn btn-xs" style="background:rgba(255,255,255,.07);color:var(--tx);" onclick="oEdit('${esc(r.id)}')" title="ØªØ¹Ø¯ÙŠÙ„"><i class="fas fa-edit"></i></button>
          <button class="btn btn-red btn-xs" onclick="delR('${esc(r.id)}')" title="Ø­Ø°Ù"><i class="fas fa-trash-alt"></i></button>
        </div>
      </td>
    </tr>`).join('');
}

async function setS(id, st) {
  const r = DB.find(x => x.id===id); if(!r) return;
  r.status = st; if(st!=='rejected') r.rejectReason='';
  const key = r._key || r.id;
  await FB.update(key, {status:st, rejectReason:r.rejectReason});
  renderAdmin();
}

async function delR(id) {
  if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø·Ù„Ø¨ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ØŸ')) return;
  const r = DB.find(x => x.id===id);
  const key = r ? (r._key || r.id) : id;
  DB = DB.filter(x => x.id!==id);
  await FB.delete(key);
  renderAdmin();
}

function oRej(id) { curRjId=id; document.getElementById('rjr').value=''; oM('ov-rej'); }

async function confRej() {
  const rsn = document.getElementById('rjr').value.trim();
  if (!rsn) { alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø³Ø¨Ø¨ Ø§Ù„Ø±ÙØ¶'); return; }
  const r = DB.find(x => x.id===curRjId);
  if (r) { r.status='rejected'; r.rejectReason=rsn; }
  const key = r ? (r._key || r.id) : curRjId;
  await FB.update(key, {status:'rejected', rejectReason:rsn});
  cM('ov-rej'); renderAdmin();
}

// â”€â”€ VIEW DETAILS (with file preview/download) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function viewR(id) {
  const r = DB.find(x => x.id===id); if(!r) return;
  const isV = r.type==='verif';
  let h = `<div style="display:flex;align-items:center;gap:8px;margin-bottom:1rem;flex-wrap:wrap;">${bTy(r.type)}<span class="td-id">${esc(r.id)}</span>${bSt(r.status)}</div>`;
  const drow = (lbl,val,pre=false) => `<div class="drow"><label>${lbl}</label><div class="val${pre?' pre':''}">${val}</div></div>`;
  const drow2 = items => `<div class="drow2">${items.map(([l,v]) => `<div class="drow"><label>${l}</label><div class="val">${v}</div></div>`).join('')}</div>`;

  h += drow2([['Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„',esc(r.fullname)],[isV?'Ø§Ù„Ù…Ù†ØµØ¨':'Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©',esc(isV?r.position:r.familyName)]]);

  if (isV) {
    h += drow('Ø§Ù„Ø¹Ù†ÙˆØ§Ù†', esc(r.address));
    h += drow('Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø³Ù„Ø§Ù„Ø©', esc(r.lineage), true);

    // Photo preview
    if (r.photo && r.photo.data) {
      h += `<div class="drow"><label>ğŸ“· Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©</label>
        <div class="file-preview">
          <img src="${r.photo.data}" alt="passport photo">
          <div class="file-actions">
            <span style="font-size:.78rem;color:var(--tx2);">${esc(r.photo.name)} (${(r.photo.size/1024).toFixed(1)} KB)</span>
            <a href="${r.photo.data}" download="${esc(r.photo.name)}" class="btn btn-green btn-xs"><i class="fas fa-download"></i> ØªØ­Ù…ÙŠÙ„</a>
          </div>
        </div>
      </div>`;
    } else {
      h += drow('ğŸ“· Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©', r.photoName ? esc(r.photoName) : 'ØºÙŠØ± Ù…ØªØ§Ø­');
    }

    // Lineage doc
    if (r.linDoc && r.linDoc.data) {
      const isPdf = r.linDoc.type === 'application/pdf';
      h += `<div class="drow"><label>ğŸ“„ ÙˆØ«ÙŠÙ‚Ø© Ø§Ù„Ø³Ù„Ø§Ù„Ø©</label>
        <div class="file-preview">
          ${!isPdf ? `<img src="${r.linDoc.data}" alt="lineage doc">` : `<div style="padding:.8rem;background:rgba(231,76,60,.1);border-radius:8px;color:#f1948a;font-size:.85rem;"><i class="fas fa-file-pdf" style="margin-left:6px;font-size:1.3rem;"></i>${esc(r.linDoc.name)}</div>`}
          <div class="file-actions">
            <span style="font-size:.78rem;color:var(--tx2);">${esc(r.linDoc.name)} (${(r.linDoc.size/1024).toFixed(1)} KB)</span>
            <a href="${r.linDoc.data}" download="${esc(r.linDoc.name)}" class="btn btn-blue btn-xs"><i class="fas fa-download"></i> ØªØ­Ù…ÙŠÙ„</a>
            ${isPdf?`<a href="${r.linDoc.data}" target="_blank" class="btn btn-purple btn-xs"><i class="fas fa-external-link-alt"></i> ÙØªØ­</a>`:''}
          </div>
        </div>
      </div>`;
    } else {
      h += drow('ğŸ“„ ÙˆØ«ÙŠÙ‚Ø© Ø§Ù„Ø³Ù„Ø§Ù„Ø©', r.linDocName ? esc(r.linDocName) : 'ØºÙŠØ± Ù…ØªØ§Ø­');
    }
  } else {
    h += drow2([['Ø±Ù‚Ù… Ø§Ù„ØªØ­Ù‚Ù‚',esc(r.verifNo)],['Ø§Ù„Ù…Ù†ØµØ¨ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨',esc(r.reqPosition)]]);
    h += drow('Ø§Ù„Ø¹Ù†ÙˆØ§Ù†', esc(r.address));
    h += drow('Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ', `<span dir="ltr">${esc(r.email)}</span>`);
  }

  h += drow2([['Ø§Ù„ØªØ§Ø±ÙŠØ®',esc(r.date)],['Ø§Ù„ÙˆÙ‚Øª',esc(r.time)]]);
  if (r.rejectReason) h += `<div class="al al-err" style="margin-top:.6rem;"><i class="fas fa-exclamation-circle"></i> Ø³Ø¨Ø¨ Ø§Ù„Ø±ÙØ¶: ${esc(r.rejectReason)}</div>`;
  // Admin PDF attachment
  if (r.adminPdf && r.adminPdf.data) {
    h += `<div class="drow" style="background:rgba(46,204,113,.06);border-color:rgba(46,204,113,.2);margin-top:.6rem;">
      <label style="color:#58d68d;"><i class="fas fa-file-pdf" style="margin-left:5px;"></i> ÙˆØ«ÙŠÙ‚Ø© Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ù…Ø±ÙÙ‚Ø© Ù…Ù† Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</label>
      <div class="file-actions" style="margin-top:.4rem;">
        <span style="font-size:.78rem;color:var(--tx2);">${esc(r.adminPdf.name||'document.pdf')} (${((r.adminPdf.size||0)/1024).toFixed(1)} KB)</span>
        <a href="${r.adminPdf.data}" download="${esc(r.adminPdf.name||'document.pdf')}" class="btn btn-green btn-xs"><i class="fas fa-download"></i> ØªØ­Ù…ÙŠÙ„</a>
        <a href="${r.adminPdf.data}" target="_blank" class="btn btn-purple btn-xs"><i class="fas fa-external-link-alt"></i> ÙØªØ­</a>
      </div>
    </div>`;
  }

  document.getElementById('view-body').innerHTML = h;
  oM('ov-view');
}

function oEdit(id) {
  const r = DB.find(x => x.id===id); if(!r) return;
  curEdId = id;
  const isV = r.type==='verif';
  let f = '';
  if (isV) {
    f = `<div class="fr2"><div class="fg"><label class="fl">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label><input id="ef-n" type="text" class="fc" value="${esc(r.fullname)}"></div><div class="fg"><label class="fl">Ø§Ù„Ù…Ù†ØµØ¨</label><input id="ef-p" type="text" class="fc" value="${esc(r.position)}"></div></div>
    <div class="fg"><label class="fl">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label><input id="ef-a" type="text" class="fc" value="${esc(r.address)}"></div>
    <div class="fg"><label class="fl">Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø³Ù„Ø§Ù„Ø©</label><textarea id="ef-l" class="fc" style="min-height:110px;">${esc(r.lineage)}</textarea></div>`;
  } else {
    f = `<div class="fr2"><div class="fg"><label class="fl">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label><input id="ef-n" type="text" class="fc" value="${esc(r.fullname)}"></div><div class="fg"><label class="fl">Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©</label><input id="ef-fm" type="text" class="fc" value="${esc(r.familyName)}"></div></div>
    <div class="fr2"><div class="fg"><label class="fl">Ø±Ù‚Ù… Ø§Ù„ØªØ­Ù‚Ù‚</label><input id="ef-vn" type="text" class="fc" value="${esc(r.verifNo)}"></div><div class="fg"><label class="fl">Ø§Ù„Ù…Ù†ØµØ¨ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨</label><input id="ef-rp" type="text" class="fc" value="${esc(r.reqPosition)}"></div></div>
    <div class="fg"><label class="fl">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label><input id="ef-a" type="text" class="fc" value="${esc(r.address)}"></div>
    <div class="fg"><label class="fl">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label><input id="ef-em" type="email" class="fc" value="${esc(r.email)}" dir="ltr"></div>`;
  }
  document.getElementById('edit-f').innerHTML = f;
  document.getElementById('e-st').value = r.status;
  // Reset PDF upload area
  document.getElementById('admin-pdf-inp').value = '';
  document.getElementById('admin-pdf-preview').style.display = 'none';
  // Show existing PDF if any
  const existingDiv = document.getElementById('admin-pdf-existing');
  if (r.adminPdf && r.adminPdf.data) {
    existingDiv.style.display = 'block';
    document.getElementById('admin-pdf-existing-name').textContent = r.adminPdf.name || 'document.pdf';
  } else {
    existingDiv.style.display = 'none';
  }
  window._adminPdfData = null;
  window._removeExistingPdf = false;
  oM('ov-edit');
}

function handleAdminPdf(inp) {
  const f = inp.files[0]; if (!f) return;
  if (f.type !== 'application/pdf') { alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù PDF ÙÙ‚Ø·'); inp.value=''; return; }
  if (f.size > 5 * 1024 * 1024) { alert('Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù ÙƒØ¨ÙŠØ± Ø¬Ø¯Ø§Ù‹. Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 5MB'); inp.value=''; return; }
  const reader = new FileReader();
  reader.onload = e => {
    window._adminPdfData = { data: e.target.result, name: f.name, type: f.type, size: f.size };
    document.getElementById('admin-pdf-name').textContent = f.name;
    document.getElementById('admin-pdf-preview').style.display = 'block';
    document.getElementById('admin-pdf-existing').style.display = 'none';
    window._removeExistingPdf = true;
  };
  reader.readAsDataURL(f);
}

function clearAdminPdf() {
  window._adminPdfData = null;
  document.getElementById('admin-pdf-inp').value = '';
  document.getElementById('admin-pdf-preview').style.display = 'none';
  const r = DB.find(x => x.id===curEdId);
  if (r && r.adminPdf && r.adminPdf.data) {
    document.getElementById('admin-pdf-existing').style.display = 'block';
    window._removeExistingPdf = false;
  }
}

function removeExistingAdminPdf() {
  window._removeExistingPdf = true;
  document.getElementById('admin-pdf-existing').style.display = 'none';
}

async function saveEd() {
  const r = DB.find(x => x.id===curEdId); if(!r) return;
  const n = document.getElementById('ef-n'); if(n) r.fullname = n.value.trim();
  r.status = document.getElementById('e-st').value;
  const updates = {fullname: r.fullname, status: r.status};
  if (r.type==='verif') {
    const p=document.getElementById('ef-p'); if(p){r.position=p.value.trim();updates.position=r.position;}
    const a=document.getElementById('ef-a'); if(a){r.address=a.value.trim();updates.address=r.address;}
    const l=document.getElementById('ef-l'); if(l){r.lineage=l.value.trim();updates.lineage=r.lineage;}
  } else {
    const fm=document.getElementById('ef-fm'); if(fm){r.familyName=fm.value.trim();updates.familyName=r.familyName;}
    const vn=document.getElementById('ef-vn'); if(vn){r.verifNo=vn.value.trim();updates.verifNo=r.verifNo;}
    const rp=document.getElementById('ef-rp'); if(rp){r.reqPosition=rp.value.trim();updates.reqPosition=r.reqPosition;}
    const a=document.getElementById('ef-a');  if(a){r.address=a.value.trim();updates.address=r.address;}
    const em=document.getElementById('ef-em'); if(em){r.email=em.value.trim();updates.email=r.email;}
  }
  // Handle admin PDF
  if (window._adminPdfData) {
    r.adminPdf = window._adminPdfData;
    updates.adminPdf = window._adminPdfData;
  } else if (window._removeExistingPdf) {
    r.adminPdf = null;
    updates.adminPdf = null;
  }
  const key = r._key || r.id;
  await FB.update(key, updates);
  cM('ov-edit'); renderAdmin();
}

// â”€â”€ PDF GENERATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function openPdfModal() { oM('ov-pdf'); }

function getPdfData() {
  const type = document.getElementById('pdf-type').value;
  const sortBy = document.getElementById('pdf-sort').value;
  let data = [...DB];

  // Filter
  if (type === 'verif') data = data.filter(r => r.type === 'verif');
  else if (type === 'memb') data = data.filter(r => r.type === 'memb');
  else if (['pending','processing','completed','rejected'].includes(type))
    data = data.filter(r => r.status === type);

  // Sort
  if (sortBy === 'date-asc') data.sort((a,b) => new Date(a.createdAt)-new Date(b.createdAt));
  else if (sortBy === 'date-desc') data.sort((a,b) => new Date(b.createdAt)-new Date(a.createdAt));
  else if (sortBy === 'status') data.sort((a,b) => (a.status||'').localeCompare(b.status||''));
  else if (sortBy === 'name') data.sort((a,b) => (a.fullname||'').localeCompare(b.fullname||''));

  return data;
}

function exportCurrentTablePdf() {
  // Quick export of currently visible table
  document.getElementById('pdf-type').value = 'all';
  document.getElementById('pdf-detail').value = 'summary';
  document.getElementById('pdf-sort').value = 'date-desc';
  generatePdf();
}

function generatePdf() {
  const { jsPDF } = window.jspdf;
  const detail = document.getElementById('pdf-detail').value;
  const type = document.getElementById('pdf-type').value;
  const data = getPdfData();
  cM('ov-pdf');

  const doc = new jsPDF({ orientation: 'landscape', unit: 'mm', format: 'a4' });
  const pageW = doc.internal.pageSize.getWidth();
  const pageH = doc.internal.pageSize.getHeight();
  const now = new Date();

  // â”€â”€ Header background
  doc.setFillColor(6, 15, 8);
  doc.rect(0, 0, pageW, pageH, 'F');

  // Gold header bar
  doc.setFillColor(201, 168, 76);
  doc.rect(0, 0, pageW, 22, 'F');

  // Title in header
  doc.setFont('helvetica', 'bold');
  doc.setFontSize(14);
  doc.setTextColor(18, 13, 0);
  doc.text('Official Verification & Membership System', pageW/2, 9, {align:'center'});
  doc.setFontSize(9);
  doc.text('Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø±Ø³Ù…ÙŠ Ù„Ù„ØªØ­Ù‚Ù‚ ÙˆØ§Ù„Ø¹Ø¶ÙˆÙŠØ©', pageW/2, 15, {align:'center'});

  // Report title below gold bar
  const typeLabels = {all:'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª â€” All Requests',verif:'Ø·Ù„Ø¨Ø§Øª Ø§Ù„ØªØ­Ù‚Ù‚ â€” Verification Requests',memb:'Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¹Ø¶ÙˆÙŠØ© â€” Membership Requests',pending:'Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± â€” Pending',processing:'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© â€” Processing',completed:'Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø© â€” Completed',rejected:'Ø§Ù„Ù…Ø±ÙÙˆØ¶Ø© â€” Rejected'};
  doc.setTextColor(201, 168, 76);
  doc.setFontSize(11);
  doc.text(typeLabels[type] || 'All Requests', pageW/2, 30, {align:'center'});

  // Meta info line
  doc.setTextColor(150, 150, 150);
  doc.setFontSize(8);
  doc.text(`Total: ${data.length} records   |   Generated: ${now.toLocaleDateString('en-GB')} ${now.toLocaleTimeString('en-GB')}   |   Admin Report`, pageW/2, 36, {align:'center'});

  // Divider
  doc.setDrawColor(201, 168, 76);
  doc.setLineWidth(0.4);
  doc.line(10, 39, pageW-10, 39);

  if (data.length === 0) {
    doc.setTextColor(200, 200, 200);
    doc.setFontSize(12);
    doc.text('No records found for this filter.', pageW/2, pageH/2, {align:'center'});
    doc.save(`report-${type}-${Date.now()}.pdf`);
    return;
  }

  const statusText = {pending:'Pending',processing:'Processing',completed:'Completed',rejected:'Rejected'};
  const typeText = {verif:'Verification',memb:'Membership'};

  if (detail === 'summary') {
    // Summary table
    const headers = [['#','ID','Type','Full Name','Position / Ref','Date','Status']];
    const rows = data.map((r, i) => [
      i + 1,
      r.id || '-',
      typeText[r.type] || r.type,
      r.fullname || '-',
      r.type==='verif' ? (r.position||'-') : (r.verifNo||'-'),
      r.date || '-',
      statusText[r.status] || r.status
    ]);

    doc.autoTable({
      head: headers,
      body: rows,
      startY: 43,
      margin: { left: 10, right: 10 },
      styles: { font: 'helvetica', fontSize: 8, cellPadding: 3, textColor: [220,220,220], fillColor: [10,25,14], lineColor: [40,60,40], lineWidth: 0.2 },
      headStyles: { fillColor: [26, 60, 30], textColor: [201, 168, 76], fontStyle: 'bold', fontSize: 8.5 },
      alternateRowStyles: { fillColor: [14, 30, 18] },
      columnStyles: {
        0: { cellWidth: 8, halign:'center' },
        1: { cellWidth: 30, textColor: [201,168,76] },
        2: { cellWidth: 25, halign:'center' },
        3: { cellWidth: 55 },
        4: { cellWidth: 45 },
        5: { cellWidth: 28 },
        6: { cellWidth: 26, halign:'center' }
      },
      didParseCell(data) {
        const statusColors = {Pending:[243,156,18],Processing:[52,152,219],Completed:[46,204,113],Rejected:[231,76,60]};
        if (data.column.index === 6 && data.section === 'body') {
          const c = statusColors[data.cell.raw];
          if (c) data.cell.styles.textColor = c;
        }
      }
    });
  } else {
    // Detailed â€” one block per record
    let y = 43;
    const lineH = 6;

    data.forEach((r, idx) => {
      // Check if need new page
      const blockH = r.type==='verif' ? 52 : 42;
      if (y + blockH > pageH - 15) {
        doc.addPage();
        doc.setFillColor(6,15,8);
        doc.rect(0,0,pageW,pageH,'F');
        y = 15;
      }

      // Record header bar
      doc.setFillColor(20, 50, 25);
      doc.roundedRect(10, y, pageW-20, 9, 1, 1, 'F');
      doc.setTextColor(201,168,76);
      doc.setFontSize(8.5);
      doc.setFont('helvetica','bold');
      doc.text(`#${idx+1}  ${r.id||''}`, 15, y+6);
      doc.text(typeText[r.type]||r.type, pageW/2, y+6, {align:'center'});
      const sc = {pending:[243,156,18],processing:[52,152,219],completed:[46,204,113],rejected:[231,76,60]};
      const col = sc[r.status] || [200,200,200];
      doc.setTextColor(...col);
      doc.text(statusText[r.status]||r.status, pageW-15, y+6, {align:'right'});
      y += 11;

      doc.setFont('helvetica','normal');
      doc.setFontSize(8);

      const field = (label, val, x, width=80) => {
        doc.setTextColor(150,150,150); doc.text(label+':', x, y);
        doc.setTextColor(220,220,220); doc.text(String(val||'-').substring(0,Math.floor(width/2.2)), x+22, y);
      };

      if (r.type === 'verif') {
        field('Full Name', r.fullname, 12); field('Position', r.position, pageW/2); y += lineH;
        field('Address', r.address, 12); field('Date', r.date, pageW/2); y += lineH;
        // Lineage (truncated)
        const lin = (r.lineage||'').split('\n').slice(0,3).join(' / ');
        doc.setTextColor(150,150,150); doc.text('Lineage:', 12, y);
        doc.setTextColor(200,200,200); doc.text(lin.substring(0,120)+(lin.length>120?'...':''), 35, y); y += lineH;
        if (r.rejectReason) { doc.setTextColor(231,76,60); doc.text('Rejection Reason: '+r.rejectReason.substring(0,120), 12, y); y += lineH; }
      } else {
        field('Full Name', r.fullname, 12); field('Family Name', r.familyName, pageW/2); y += lineH;
        field('Verif No', r.verifNo, 12); field('Position', r.reqPosition, pageW/2); y += lineH;
        field('Email', r.email, 12); field('Date', r.date, pageW/2); y += lineH;
        if (r.rejectReason) { doc.setTextColor(231,76,60); doc.text('Rejection Reason: '+r.rejectReason.substring(0,120), 12, y); y += lineH; }
      }

      // Separator
      doc.setDrawColor(30,60,35);
      doc.setLineWidth(0.2);
      doc.line(10, y+1, pageW-10, y+1);
      y += 5;
    });
  }

  // Footer on each page
  const totalPages = doc.internal.getNumberOfPages();
  for (let pg = 1; pg <= totalPages; pg++) {
    doc.setPage(pg);
    doc.setFillColor(201,168,76);
    doc.rect(0, pageH-8, pageW, 8, 'F');
    doc.setTextColor(18,13,0);
    doc.setFontSize(7);
    doc.setFont('helvetica','normal');
    doc.text(`Page ${pg} of ${totalPages}  |  Confidential â€” Admin Use Only  |  ${now.toLocaleDateString('en-GB')}`, pageW/2, pageH-3, {align:'center'});
  }

  const fileName = `report-${type}-${now.toISOString().split('T')[0]}.pdf`;
  doc.save(fileName);
}

// â”€â”€ MODAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function oM(id) { document.getElementById(id).classList.add('open'); }
function cM(id) { document.getElementById(id).classList.remove('open'); }
document.querySelectorAll('.overlay').forEach(m => m.addEventListener('click', e => { if(e.target===m) m.classList.remove('open'); }));
</script>
</body>
</html>
